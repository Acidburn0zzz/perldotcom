<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Office on Perl.com - programming news, code and culture</title>
    <link>http://localhost:1313/tags/office/</link>
    <description>Recent content in Office on Perl.com - programming news, code and culture</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Tue, 05 Aug 2014 13:41:48 +0000</lastBuildDate>
    <atom:link href="/tags/office/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Parse Excel with ease using Perl</title>
      <link>http://localhost:1313/article/108/2014/8/5/Parse-Excel-with-ease-using-Perl/</link>
      <pubDate>Tue, 05 Aug 2014 13:41:48 +0000</pubDate>
      
      <guid>http://localhost:1313/article/108/2014/8/5/Parse-Excel-with-ease-using-Perl/</guid>
      <description>

&lt;p&gt;In the business world, it seems like Excel spreadsheets are everywhere. Recently I had to parse several hundred spreadsheets under a tight deadline for a client. To make matters worse, the spreadsheets were in a mix of Excel 2003 (xls) and 2007 (xlsx) formats. Fortunately I know Perl, and using the Spreadsheet::Read module, it was easy. This article will show you how to use Spreadsheet::Read to parse Excel spreadsheets.&lt;/p&gt;

&lt;h3 id=&#34;requirements&#34;&gt;Requirements&lt;/h3&gt;

&lt;p&gt;You&amp;rsquo;ll need to install &lt;a href=&#34;https://metacpan.org/pod/Spreadsheet::Read&#34;&gt;Spreadsheet::Read&lt;/a&gt; and a couple of interface modules. &lt;a href=&#34;https://metacpan.org/pod/Spreadsheet::ParseExcel&#34;&gt;Spreadsheet::ParseExcel&lt;/a&gt; is an interface for Excel 2003 spreadsheets and &lt;a href=&#34;https://metacpan.org/pod/Spreadsheet::XLSX&#34;&gt;Spreadsheet::XLSX&lt;/a&gt; is for reading the modern Excel format. You can install all three modules from the terminal using cpan:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;$ cpan Spreadsheet::ParseExcel Spreadsheet::XLSX Spreadsheet::Read&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;h3 id=&#34;using-spreadsheet-read&#34;&gt;Using Spreadsheet::Read&lt;/h3&gt;

&lt;p&gt;Let&amp;rsquo;s parse the spreadsheet shown in the cover image, which contains an income statement. Spreadsheet::Read provides a simple, unified interface for reading spreadsheets. It exports the &lt;code&gt;ReadData&lt;/code&gt; function which requires a filepath to the spreadsheet:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;use&lt;/span&gt; Spreadsheet::Read;

&lt;span style=&#34;color:#66d9ef&#34;&gt;my&lt;/span&gt; $workbook &lt;span style=&#34;color:#f92672&#34;&gt;=&lt;/span&gt; ReadData(&lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#39;income_statement.xlsx&amp;#39;&lt;/span&gt;);&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Now &lt;code&gt;$workbook&lt;/code&gt; contains the data structure representing the spreadsheet. We can inspect this structure by printing it with &lt;a href=&#34;https://metacpan.org/pod/Data::Printer&#34;&gt;Data::Printer&lt;/a&gt;:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#f92672&#34;&gt;\&lt;/span&gt; [
    [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] {
        error     undef,
        parser    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Spreadsheet::XLSX&amp;#34;&lt;/span&gt;,
        sheet     {
            Sheet1   &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;
        },
        sheets    &lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;,
        type      &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;xlsx&amp;#34;&lt;/span&gt;,
        version   &lt;span style=&#34;color:#ae81ff&#34;&gt;0.13&lt;/span&gt;
    },
    [&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;] {
        attr     &lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;,
        B1       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Income Statement 2014&amp;#34;&lt;/span&gt;,
        B2       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Revenue&amp;#34;&lt;/span&gt;,
        B3       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cost of goods sold&amp;#34;&lt;/span&gt;,
        B4       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Gross profit&amp;#34;&lt;/span&gt;,
        B5       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Financing costs&amp;#34;&lt;/span&gt;,
        B6       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tax&amp;#34;&lt;/span&gt;,
        B7       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Net profit&amp;#34;&lt;/span&gt;,
        cell     [
            [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;,
            [&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;] &lt;span style=&#34;color:#f92672&#34;&gt;[]&lt;/span&gt;,
            [&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;] [
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] undef,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Income Statement 2014&amp;#34;&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Revenue&amp;#34;&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Cost of goods sold&amp;#34;&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Gross profit&amp;#34;&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Financing costs&amp;#34;&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Tax&amp;#34;&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;] &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Net profit&amp;#34;&lt;/span&gt;
            ],
            [&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;] [
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;0&lt;/span&gt;] undef,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;] undef,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;] &lt;span style=&#34;color:#ae81ff&#34;&gt;50000&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;] &lt;span style=&#34;color:#ae81ff&#34;&gt;2500&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;4&lt;/span&gt;] &lt;span style=&#34;color:#ae81ff&#34;&gt;47500&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;5&lt;/span&gt;] &lt;span style=&#34;color:#ae81ff&#34;&gt;7150&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;6&lt;/span&gt;] &lt;span style=&#34;color:#ae81ff&#34;&gt;10087.5&lt;/span&gt;,
                [&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;] &lt;span style=&#34;color:#ae81ff&#34;&gt;30262.5&lt;/span&gt;
            ]
        ],
        C2       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; $ 50,000.00 &amp;#34;&lt;/span&gt;,
        C3       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; $ 2,500.00 &amp;#34;&lt;/span&gt;,
        C4       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; $ 47,500.00 &amp;#34;&lt;/span&gt;,
        C5       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; $ 7,150.00 &amp;#34;&lt;/span&gt;,
        C6       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; $ 10,087.50 &amp;#34;&lt;/span&gt;,
        C7       &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34; $ 30,262.50 &amp;#34;&lt;/span&gt;,
        label    &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;Sheet1&amp;#34;&lt;/span&gt;,
        maxcol   &lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;,
        maxrow   &lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;
    }
]&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;This shows that &lt;code&gt;$workbook&lt;/code&gt; is an arrayref, whose first element describes the file, and subsequent elements represent the individual worksheets. The &lt;code&gt;label&lt;/code&gt; key pair contains the worksheet name, access it like this:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;$workbook&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]{label}; &lt;span style=&#34;color:#75715e&#34;&gt;#Sheet1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;Cells can be referenced using Excel&amp;rsquo;s grid notation (&amp;ldquo;A3&amp;rdquo;) or via standard Perl array access. The different between these is formatting:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;$workbook&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]{C2}; &lt;span style=&#34;color:#75715e&#34;&gt;#$ 50,000.00&lt;/span&gt;

$workbook&lt;span style=&#34;color:#f92672&#34;&gt;-&amp;gt;&lt;/span&gt;[&lt;span style=&#34;color:#ae81ff&#34;&gt;1&lt;/span&gt;]{cell}[&lt;span style=&#34;color:#ae81ff&#34;&gt;3&lt;/span&gt;][&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;]; &lt;span style=&#34;color:#75715e&#34;&gt;#50000&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;So if you need to perform additional processing on the data you&amp;rsquo;re extracting (such as saving to a database), you probably want to use the &lt;code&gt;{cell}&lt;/code&gt; notation, to obtain clean data. With Spreadsheet::Read array indexes begin at 1, so cell &amp;ldquo;C2&amp;rdquo; is [3][2].&lt;/p&gt;

&lt;p&gt;Perhaps you want to loop through two columns at once and print them? No problem:&lt;/p&gt;
&lt;div class=&#34;highlight&#34;&gt;&lt;pre style=&#34;color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4&#34;&gt;&lt;code class=&#34;language-perl&#34; data-lang=&#34;perl&#34;&gt;&lt;span style=&#34;color:#66d9ef&#34;&gt;for&lt;/span&gt; (&lt;span style=&#34;color:#ae81ff&#34;&gt;2&lt;/span&gt;&lt;span style=&#34;color:#f92672&#34;&gt;..&lt;/span&gt;&lt;span style=&#34;color:#ae81ff&#34;&gt;7&lt;/span&gt;) {
    &lt;span style=&#34;color:#66d9ef&#34;&gt;print&lt;/span&gt; &lt;span style=&#34;color:#e6db74&#34;&gt;&amp;#34;$workbook-&amp;gt;[1]{cell}[2][$_]: $workbook-&amp;gt;[1]{cell}[3][$_]\n&amp;#34;&lt;/span&gt;; 
}&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;
&lt;p&gt;There are some data points which Spreadsheet::Read does not provide: you cannot access the underlying formula of a cell and the styling data is also not available.&lt;/p&gt;

&lt;h3 id=&#34;conclusion&#34;&gt;Conclusion&lt;/h3&gt;

&lt;p&gt;Spreadsheet::Read isn&amp;rsquo;t just great for command line apps, it has many uses. Unlike the Microsoft .Net interop library, Perl&amp;rsquo;s Excel interfaces are not single threaded and do not require Excel to be installed to work. Instead Spreadsheet::Read directly parses the Excel file. That makes it possible to process large computing tasks in parallel. Another possible use case is for a spreadsheet upload interface on a web application; Spreadsheet::Read also supports the Libre / Open Office formats as well as CSV text files.&lt;/p&gt;

&lt;p&gt;&lt;br /&gt;
&lt;em&gt;This article was originally posted on &lt;a href=&#34;http://perltricks.com&#34;&gt;PerlTricks.com&lt;/a&gt;.&lt;/em&gt;&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>

