<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<?xml version="1.0" encoding="UTF-8"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Perl Web Programming on Perl.com - programming news, code and culture</title>
    <link>http://localhost:1313/tags/perl-web-programming/</link>
    <description>Recent content in Perl Web Programming on Perl.com - programming news, code and culture</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <lastBuildDate>Thu, 02 Mar 2006 00:00:00 -0800</lastBuildDate>
    <atom:link href="/tags/perl-web-programming/" rel="self" type="application/rss+xml" />
    
    <item>
      <title>Using Ajax from Perl</title>
      <link>http://localhost:1313/pub/2006/03/02/ajax_and_perl.html/</link>
      <pubDate>Thu, 02 Mar 2006 00:00:00 -0800</pubDate>
      
      <guid>http://localhost:1313/pub/2006/03/02/ajax_and_perl.html/</guid>
      <description>

&lt;p&gt;If you&amp;rsquo;re even remotely connected to web development, you can&amp;rsquo;t have failed to have heard of Ajax at some point in the last year. It probably sounded like the latest buzzword and was one of those things you stuck on the &amp;ldquo;must read up on later&amp;rdquo; pile. While it&amp;rsquo;s definitely a buzzword, it&amp;rsquo;s also quite a useful one.&lt;/p&gt;

&lt;p&gt;Ajax stands for &amp;ldquo;Asynchronous JavaScript and XML.&amp;rdquo; It&amp;rsquo;s a term coined by Jesse James Garret in &amp;ldquo;&lt;a href=&#34;http://www.adaptivepath.com/publications/essays/archives/000385.php&#34;&gt;Ajax: A New Approach to Web Applications&lt;/a&gt;.&amp;rdquo; Ignore the &lt;a href=&#34;http://www.ajax.nl/&#34;&gt;football team&lt;/a&gt;, they&amp;rsquo;re mere impostors. ;-)&lt;/p&gt;

&lt;p&gt;What does that actually &lt;em&gt;mean&lt;/em&gt;? In short, it&amp;rsquo;s about making your web pages more interactive. At the core, Ajax techniques let you update parts of your web page without reloading the whole page from scratch. This enables some very cool effects. Many people cite &lt;a href=&#34;http://maps.google.co.uk/maps?q=brighton&amp;amp;hl=en&#34;&gt;Google Maps&lt;/a&gt; and &lt;a href=&#34;http://gmail.google.com/&#34;&gt;Gmail&lt;/a&gt; as great examples of what you can do with this, but my favorite bit of Ajax is part of &lt;a href=&#34;http://www.flickr.com/&#34;&gt;Flickr&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;When you log in to Flickr, you can see the photos that you have just uploaded. In this example, it&amp;rsquo;s something I&amp;rsquo;ve snapped from my camera while out cycling. Unfortunately, the phone has given it a default filename, which is quite uninformative (Figure 1).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2006_03_02_ajax_and_perl/flickr1.png&#34; alt=&#34;The original photo in Flickr&#34; width=&#34;371&#34; height=&#34;365&#34; /&gt;
&lt;em&gt;Figure 1. The original photo in Flickr&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;If you click on the title, it turns into a highlighted text box (Figure 2).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2006_03_02_ajax_and_perl/flickr2.png&#34; alt=&#34;Editing the photo title&#34; width=&#34;366&#34; height=&#34;107&#34; /&gt;
&lt;em&gt;Figure 2. Editing the photo title&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;After changing it to something more suitable, hit the Save button and the screen briefly tells you what it&amp;rsquo;s doing, before returning to its original form (Figure 3).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2006_03_02_ajax_and_perl/flickr3.png&#34; alt=&#34;Finished editing the photo title&#34; width=&#34;363&#34; height=&#34;64&#34; /&gt;
&lt;em&gt;Figure 3. Finished editing the photo title&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Behind the scenes, Flickr uses JavaScript to make a separate call back to the server to update the details. It does so by using something called &lt;a href=&#34;http://www.xml.com/pub/2005/02/09/xml-http-request.html&#34;&gt;XMLHttpRequest&lt;/a&gt;. You&amp;rsquo;ll hear a lot about this as you explore Ajax.&lt;/p&gt;

&lt;p&gt;Flickr lets you edit most of the details of your photo without having to go to a separate edit page. It&amp;rsquo;s a very simple enhancement, but one that makes the whole application much easier to use. It&amp;rsquo;s well worth getting to know these sorts of techniques in order to spice up your own applications. It&amp;rsquo;s also worth pointing out that they are &lt;em&gt;enhancements&lt;/em&gt;. If you have JavaScript turned off, Flickr will still let you edit the photo details. You just have to use a separate edit screen and a round trip to the server. Using Ajax lets you streamline your users&amp;rsquo; experience.&lt;/p&gt;

&lt;p&gt;What about all this messy JavaScript? Didn&amp;rsquo;t we get rid of all that a few years ago? Well, yes. The kind of JavaScript that looks like &lt;a href=&#34;http://perlgolf.sourceforge.net/&#34;&gt;Perl Golf&lt;/a&gt; is long gone, and good riddance. I&amp;rsquo;m sure you feel the same way about those Perl 4 scripts you wrote a few years back, before you discovered how modules work in Perl 5. Modern JavaScript is a different beast. It&amp;rsquo;s relatively standard, so the cross-browser problems of the past are gone or greatly diminished. There&amp;rsquo;s also a renewed focus on making JavaScript as unobtrusive as possible. With all of this change, there&amp;rsquo;s even an attempt to rebrand JavaScript in the browser as &lt;a href=&#34;http://domscripting.webstandards.org/?page_id=4&#34;&gt;DOM scripting&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;There are several bits to Ajax:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Asynchronous: Making sure that any activity doesn&amp;rsquo;t lock up the browser while it happens.&lt;/li&gt;
&lt;li&gt;JavaScript: For manipulating the page inside of the web browser.&lt;/li&gt;
&lt;li&gt;XML: For returning data from the server.&lt;/li&gt;
&lt;/ul&gt;

&lt;h3 id=&#34;ajax-and-perl-cgi-ajax&#34;&gt;Ajax and Perl: &lt;code&gt;CGI::Ajax&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;You could spend a lot of time figuring out all the pieces of JavaScript on the client side and Perl on the server side in order to work out how to use Ajax in your code. However, this is Perl; we like to be a bit lazy. Thankfully, there&amp;rsquo;s already a module on CPAN to take the pain out of it: &lt;a href=&#34;https://metacpan.org/pod/CGI::Ajax&#34;&gt;CGI::Ajax&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;&lt;code&gt;CGI::Ajax&lt;/code&gt; provides a small bit of infrastructure for your CGI programs. You tell it about some of your functions and it sets up JavaScript to call them and return the results to your page. You don&amp;rsquo;t need to worry about writing the JavaScript to do this, because &lt;code&gt;CGI::Ajax&lt;/code&gt; takes care of it. All you have to do is add some JavaScript calls to the functions defined in your script and let &lt;code&gt;CGI::Ajax&lt;/code&gt; deal with the plumbing.&lt;/p&gt;

&lt;p&gt;The functions that &lt;code&gt;CGI::Ajax&lt;/code&gt; creates in JavaScript for you all follow more or less the same pattern. They take two parameters: a list of HTML IDs to get input from, and a second list of HTML IDs to insert the results into. Having ID attributes in your HTML is a prerequisite for enabling this behavior. &lt;code&gt;CGI::Ajax&lt;/code&gt; handles querying your web page for the input values and inserting the results when the answer comes back from the server.&lt;/p&gt;

&lt;p&gt;By making functions in your CGI script available to the browser, you have the ability to do things that you can&amp;rsquo;t ordinarily do. For instance, you can look up values in a database, or query the system load average. Anything you can do in Perl that you couldn&amp;rsquo;t in JavaScript now becomes possible.&lt;/p&gt;

&lt;h3 id=&#34;checking-usernames&#34;&gt;Checking Usernames&lt;/h3&gt;

&lt;p&gt;To explore &lt;code&gt;CGI::Ajax&lt;/code&gt;, consider a typical problem. You have a signup page for an application. You have to enter a username and password in order to register with the application. Because this is such a wildly popular application, the username you want is probably taken. Unfortunately, you have to resubmit the entire form and wait for the server to receive it before being told that you can&amp;rsquo;t have the username &lt;em&gt;fluffykitten&lt;/em&gt;. How can &lt;code&gt;CGI::Ajax&lt;/code&gt; can help you to solve this?&lt;/p&gt;

&lt;p&gt;Start by making a basic CGI script to handle registrations. I&amp;rsquo;m going to make it very minimal in order to try and focus on the problem at hand. Feel free to embellish it once you have it up and running. I&amp;rsquo;ll walk through the script below, but you can also &lt;a href=&#34;http://localhost:1313/media/_pub_2006_03_02_ajax_and_perl/normal.zip&#34;&gt;download the registration script&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;It starts off like all good Perl code, by using the &lt;code&gt;strict&lt;/code&gt; and &lt;code&gt;warnings&lt;/code&gt; modules, followed by the only other necessary module: &lt;em&gt;CGI.pm&lt;/em&gt;. It creates a new &lt;code&gt;CGI&lt;/code&gt; object and then calls &lt;code&gt;main()&lt;/code&gt; to do the real work.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/usr/local/bin/perl
# User registration script.
use strict;
use warnings;

use CGI;
my $cgi  = CGI-&amp;gt;new();
main();
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Most of &lt;code&gt;main()&lt;/code&gt; deals with putting together bits of HTML. For a real-world script, use something like &lt;a href=&#34;https://github.com/mpeters/html-template&#34;&gt;HTML::Template&lt;/a&gt; or &lt;a href=&#34;http://www.template-toolkit.org/&#34;&gt;Template Toolkit&lt;/a&gt; instead of putting HTML directly in the script.&lt;/p&gt;

&lt;p&gt;The interesting stuff happens in the middle. First it checks for a passed-in &lt;code&gt;user&lt;/code&gt; parameter. If so, the code checks that it looks good and records that username in our database. If there were any problems, it mentions those as well. At the end, it sends the created HTML to the browser for display.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sub main {
    my $html = &amp;lt;&amp;lt;HTML;
&amp;lt;html&amp;gt;&amp;lt;head&amp;gt;
&amp;lt;title&amp;gt;Ordinary CGI demo&amp;lt;/title&amp;gt;
&amp;lt;/head&amp;gt;&amp;lt;body&amp;gt;
&amp;lt;h1&amp;gt;Signup!&amp;lt;/h1&amp;gt;
HTML
    if ( my $user = $cgi-&amp;gt;param(&#39;user&#39;) ) {
        my $err = check_username( $user );
        if ( $err ) {
            $html .= &amp;quot;&amp;lt;p class=&#39;problem&#39;&amp;gt;$err&amp;lt;/p&amp;gt;&amp;quot;;
        } else {
            save_username( $user );
            $html .= &amp;quot;&amp;lt;p&amp;gt;Account &amp;lt;em&amp;gt;$user&amp;lt;/em&amp;gt; created!&amp;lt;/p&amp;gt;\n&amp;quot;;
        }
    }
    my $url = $cgi-&amp;gt;url(-relative =&amp;gt; 1);
    $html .= &amp;lt;&amp;lt;HTML;
&amp;lt;form action=&amp;quot;$url&amp;quot; method=&amp;quot;post&amp;quot;&amp;gt;
&amp;lt;p&amp;gt;Please fill in the details to create a new Account.&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;Username: &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;user&amp;quot; id=&amp;quot;user&amp;quot;/&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;Password: &amp;lt;input type=&amp;quot;password&amp;quot; name=&amp;quot;pass&amp;quot; id=&amp;quot;pass&amp;quot;/&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;p&amp;gt;&amp;lt;input type=&amp;quot;submit&amp;quot; name=&amp;quot;submit&amp;quot; value=&amp;quot;SIGNUP&amp;quot;/&amp;gt;&amp;lt;/p&amp;gt;
&amp;lt;/form&amp;gt;&amp;lt;/body&amp;gt;&amp;lt;/html&amp;gt;
HTML
    print $cgi-&amp;gt;header();
    print $html;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;In order to implement a user database simply, I decided to store a list of users in a text file, one per line. To check if a username is taken, the code reads the file and compares each line to the passed-in value, case-insensitively. If there are any problems, they&amp;rsquo;re returned as a string. If the file doesn&amp;rsquo;t exist, then the code allows any username (this helps to avoid errors the first time you run the script). Again, a real application would probably store users in a database using &lt;code&gt;DBI&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sub check_username {
    my ( $user ) = @_;
    return unless -f &#39;/tmp/users.txt&#39;;
    open my $fh, &#39;&amp;lt;&#39;, &#39;/tmp/users.txt&#39;
      or return &amp;quot;open(/tmp/users.txt): $!&amp;quot;;
    while (&amp;lt;$fh&amp;gt;) {
        chomp;
        return &amp;quot;Username taken!&amp;quot; if lc $_ eq lc $user;
    }
    return;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Lastly, in order to save a username, the code must append it onto the end of the file.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sub save_username {
    my ( $user ) = @_;
    open my $fh, &#39;&amp;gt;&amp;gt;&#39;, &#39;/tmp/users.txt&#39;
      or die &amp;quot;open(&amp;gt;&amp;gt;/tmp/users.txt): $!&amp;quot;;
    print $fh &amp;quot;$user\n&amp;quot;;
    close $fh;
    return;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now you should have a script that lets you enter usernames and record them into a file. If you try to enter the same name twice, it will stop you, just like Hotmail. Now imagine that, like Hotmail, you also had to spend a while trying to interpret a &lt;a href=&#34;http://en.wikipedia.org/wiki/Captcha&#34;&gt;captcha&lt;/a&gt; image as well. Then, when you&amp;rsquo;ve finally managed to work out what letter that strange squiggle represents, you hit Submit only to be told that the username you entered doesn&amp;rsquo;t matter. Then you have to think of another username and try to decipher another set of odd-looking lines. You can see it&amp;rsquo;s important to tell the user as soon as possible that a username is unavailable.&lt;/p&gt;

&lt;h3 id=&#34;enter-cgi-ajax&#34;&gt;Enter &lt;code&gt;CGI::Ajax&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;With a few small modifications, you can make the script use Ajax to check whether the username is valid. That way, any problems will show up immediately. There aren&amp;rsquo;t many changes. At the top of the script, load the &lt;code&gt;CGI::Ajax&lt;/code&gt; module and make a new object. At the same time, register the function &lt;code&gt;check_username()&lt;/code&gt; as being callable via Ajax. After that, instead of calling &lt;code&gt;main()&lt;/code&gt; directly, call &lt;code&gt;build_html()&lt;/code&gt;, passing in a reference to &lt;code&gt;main()&lt;/code&gt;. This is a very important part of how &lt;code&gt;CGI::Ajax&lt;/code&gt; does its work. It gives &lt;code&gt;CGI::Ajax&lt;/code&gt; the ability to intercept the regular flow of control when it needs to. You can also &lt;a href=&#34;http://localhost:1313/media/_pub_2006_03_02_ajax_and_perl/ajax.zip&#34;&gt;download the Ajax-enabled login code&lt;/a&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;#!/usr/local/bin/perl
# User registration script.

use strict;
use warnings;

use CGI;
use CGI::Ajax;

my $cgi  = CGI-&amp;gt;new();
my $ajax = CGI::Ajax-&amp;gt;new( check_username =&amp;gt; \&amp;amp;check_username );
print $ajax-&amp;gt;build_html( $cgi, \&amp;amp;main );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The only other structural change is in the &lt;code&gt;main()&lt;/code&gt; function. Instead of printing a header and the generated HTML, it now returns the content.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;sub main {
    # ...
    # print $cgi-&amp;gt;header();
    # print $html;
    return $html;
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;After doing that, &lt;code&gt;CGI::Ajax will&lt;/code&gt; send the content to the browser for you.&lt;/p&gt;

&lt;p&gt;With the server side of Ajax covered, it&amp;rsquo;s time to look at the client side. The client needs to take advantage of the features that &lt;code&gt;CGI::Ajax&lt;/code&gt; provides. To do this, you need a little bit of JavaScript. If you view the source of this second script, you&amp;rsquo;ll see that &lt;code&gt;CGI::Ajax&lt;/code&gt; has inserted some JavaScript at the end of the &lt;code&gt;&amp;lt;head&amp;gt;&lt;/code&gt; section. This is the code that exposes your Perl functions to JavaScript. All that remains is to connect up events that occur in the page to those exposed Perl functions.&lt;/p&gt;

&lt;p&gt;If you&amp;rsquo;ve used JavaScript before, you&amp;rsquo;re probably thinking about an &lt;code&gt;onchange&lt;/code&gt; attribute now. That&amp;rsquo;s the right thought (to trigger the Ajax call when the username field changes), but it&amp;rsquo;s not an ideal way of doing things, because it&amp;rsquo;s &lt;em&gt;intrusive&lt;/em&gt;. There&amp;rsquo;s really no need for there to be JavaScript in the HTML at all. Instead, create a small file to bind the markup to the exposed Perl functions (&lt;a href=&#34;http://localhost:1313/media/_pub_2006_03_02_ajax_and_perl/binding.js&#34;&gt;download &lt;em&gt;binding.js&lt;/em&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;It starts off with the &lt;a href=&#34;http://simon.incutio.com/archive/2004/05/26/addLoadEvent&#34;&gt;&lt;code&gt;addLoadEvent&lt;/code&gt;&lt;/a&gt; function from Simon Willison. This function takes a piece of JavaScript and runs it when the page has finished loading. The useful bit is that you can call it more than once without ill effects. You could use the &lt;code&gt;window.onload&lt;/code&gt; handler directly, but that would remove any previous code that had attached itself. By using &lt;code&gt;addLoadEvent()&lt;/code&gt; everywhere, this ceases to be a problem.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// Run code when the page loads.
function addLoadEvent(func) {
  var oldonload = window.onload;
  if (typeof window.onload != &#39;function&#39;) {
    window.onload = func;
  } else {
    window.onload = function() {
      oldonload();
      func();
    }
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;The next bit of JavaScript does the real work. Before doing anything, though, there is a small check to make sure that the browser is capable of handling all of this Ajax. By specifying the name of a browser function (&lt;code&gt;document.getElementById&lt;/code&gt;) without the trailing parentheses, JavaScript returns a reference to it. If the function doesn&amp;rsquo;t exist, it will return &lt;code&gt;null&lt;/code&gt; instead. If that function doesn&amp;rsquo;t exist, the code just returns straight away, resulting in no Ajax features on this page. This is &lt;a href=&#34;http://webtips.dan.info/graceful.html&#34;&gt;graceful degradation&lt;/a&gt;, as it lets the ordinary page behavior occur if the enhanced behavior won&amp;rsquo;t work.&lt;/p&gt;

&lt;p&gt;When the code knows that it&amp;rsquo;s safe to proceed, it queries the document for our username input element. If it finds it, the code arranges to call the &lt;code&gt;check_username()&lt;/code&gt; function every time the username field changes. The two parameters are lists of IDs in the document. The first one is a list of parameters whose values to pass into &lt;code&gt;check_username()&lt;/code&gt; on the server. The second list contains IDs where to insert the return values from the function.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;// Set up functions to run when events occur.
function installHandlers() {
  if (!document.getElementById) return;
  var user = document.getElementById(&#39;user&#39;);
  if (user) {
      // When the user leaves this element, call the server.
      user.onchange = function() {
          check_username([&#39;user&#39;], [&#39;baduser&#39;]);
      }
  }
}
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With &lt;code&gt;installHandlers()&lt;/code&gt; defined, all that remains is to ensure that it actually runs when the page loads.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;addLoadEvent( installHandlers );
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With &lt;em&gt;binding.js&lt;/em&gt; completed, you need to make two small changes to the generated HTML. First, include a &lt;code&gt;script&lt;/code&gt; tag to actually load it:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;script type=&amp;quot;text/javascript&amp;quot; src=&amp;quot;binding.js&amp;quot;&amp;gt;&amp;lt;/script&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Secondly, to create an element with an ID of &lt;code&gt;baduser&lt;/code&gt; into which to insert the results. I created an empty emphasis tag just after the &lt;code&gt;username&lt;/code&gt; field.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;&amp;lt;p&amp;gt;Username: &amp;lt;input type=&amp;quot;text&amp;quot; name=&amp;quot;user&amp;quot; id=&amp;quot;user&amp;quot;/&amp;gt;
&amp;lt;em id=&amp;quot;baduser&amp;quot;&amp;gt;&amp;lt;/em&amp;gt;&amp;lt;/p&amp;gt;
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With that in place, you should be able to register a username, and then watch it fail when you try to register it a second time. See how it&amp;rsquo;s immediately noticeable that the username is invalid.&lt;/p&gt;

&lt;h3 id=&#34;inside-cgi-ajax&#34;&gt;Inside &lt;code&gt;CGI::Ajax&lt;/code&gt;&lt;/h3&gt;

&lt;p&gt;Now you know how to use &lt;code&gt;CGI::Ajax&lt;/code&gt; to update your web pages dynamically. What actually happens inside to make it all work? You&amp;rsquo;ve already seen how the JavaScript version of &lt;code&gt;check_username()&lt;/code&gt; gathers the values from the input fields and passes them back to your original CGI script. You can see the calls that happen when you insert an extra line into the script, just after you create the &lt;code&gt;CGI::Ajax&lt;/code&gt; object.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ajax-&amp;gt;JSDEBUG(1);
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;With that in place, &lt;code&gt;CGI::Ajax&lt;/code&gt; will log each call that it makes to the server at the bottom of your web page. On my server, it looks something like this:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;http://localhost/~dom/cgi-ajax/ajax.cgi?fname=check_username&amp;amp;args=dom&amp;amp;user=dom
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;If you click on the link, you&amp;rsquo;ll see that it returns the string &lt;code&gt;Username &#39;dom&#39; taken!&lt;/code&gt; and nothing else. It completely ignores the bulk of the program and just sends the result of &lt;code&gt;check_username()&lt;/code&gt;. When the main part of the program calls &lt;code&gt;$ajax-&amp;gt;build_html()&lt;/code&gt;, &lt;code&gt;CGI::Ajax&lt;/code&gt; checks for the presence of a parameter called &lt;code&gt;fname&lt;/code&gt;. If it finds one, then it checks to see if that function has been registered. If so, it calls it, passing in any &lt;code&gt;args&lt;/code&gt; parameters. It then returns the results of that single function back to the browser, completely sidestepping the main program.&lt;/p&gt;

&lt;h3 id=&#34;cgi-ajax-in-the-real-world&#34;&gt;&lt;code&gt;CGI::Ajax&lt;/code&gt; in the Real World&lt;/h3&gt;

&lt;p&gt;Ajax is a tool, just like the many others you already have available when programming for the Web. There are places when it&amp;rsquo;s more or less appropriate to use it, the same as &lt;code&gt;table&lt;/code&gt; elements in HTML. The reason I chose username validation as an example is because I think it&amp;rsquo;s a good example of where Ajax can be used to really add something to an existing web application. Using Ajax to enhance forms, particularly long complicated ones, can work wonders for usability. There are other places, as well. As I pointed out at the start with Flickr, inline editing can be a great boon.&lt;/p&gt;

&lt;p&gt;Like all tools, knowing when not to use it is as important as when to use it. Packages like &lt;code&gt;CGI::Ajax&lt;/code&gt; make it astonishingly easy to use Ajax, so you need to exercise restraint. It&amp;rsquo;s all too simple to add a dash of Ajax where perhaps it would be more appropriate to reload the whole page. If you find that you&amp;rsquo;re updating most of the page with an Ajax call, then it&amp;rsquo;s more than likely not worth bothering with Ajax at all. Really, the best guideline is to do some usability testing. Think about how your users interact with your application. What&amp;rsquo;s the best way that you can help them achieve what they are trying to do?&lt;/p&gt;

&lt;p&gt;There are several good resources available for deciding when to and not to use Ajax. The most complete appears to be &lt;a href=&#34;http://ajaxpatterns.org/&#34;&gt;Ajax Patterns&lt;/a&gt;, which should arrive as an O&amp;rsquo;Reilly book at some time. A weblog post from Alex Bosworth gives his opinions on &amp;ldquo;&lt;a href=&#34;http://www.sourcelabs.com/blogs/ajb/2005/12/10_places_you_must_use_ajax.html&#34;&gt;Ten Places You Must Use Ajax&lt;/a&gt;&amp;rdquo; (even though it&amp;rsquo;s only really six). Alex also has a good piece on &amp;ldquo;&lt;a href=&#34;http://sourcelabs.com/ajb/archives/2005/05/ajax_mistakes.html&#34;&gt;Ajax Mistakes&lt;/a&gt;,&amp;rdquo; which is also worth paying attention to.&lt;/p&gt;

&lt;p&gt;There are also technical reasons to consider when implementing Ajax in your application. You have to realize that any user at all can access the server-side functions that you are exposing, even though you might think of them as internal-only. Your application suddenly has an API. For security or performance reasons, you might want to reconsider what you are exposing (although this advice applies equally well to regular web pages in your application). Also note that the API that you get from &lt;code&gt;CGI::Ajax&lt;/code&gt; binds tightly to the internals of your application. If you change the name of an exported function, you have just changed the API. If the API is part of a large, ongoing project, you might wish to consider spending some time looking at more &lt;a href=&#34;http://en.wikipedia.org/wiki/Representational_State_Transfer&#34;&gt;REST&lt;/a&gt;-like interfaces instead. These tend to be easier to work with for programmers in other languages.&lt;/p&gt;

&lt;p&gt;Now that your site actually has an API, you might want to consider documenting how it works so that your users can build on it. This is something that Flickr has done to great effect. There are now tools that exist that the Flickr folk had never thought about, simply because they let their users get access to an API.&lt;/p&gt;

&lt;p&gt;Don&amp;rsquo;t let all this deter you; you&amp;rsquo;ve seen how easy it is to add some sparkle to your application. Have a think about how you can make your users&amp;rsquo; lives easier.&lt;/p&gt;
</description>
    </item>
    
    <item>
      <title>Building E-Commerce Sites with Handel</title>
      <link>http://localhost:1313/pub/2005/11/17/handel.html/</link>
      <pubDate>Thu, 17 Nov 2005 00:00:00 -0800</pubDate>
      
      <guid>http://localhost:1313/pub/2005/11/17/handel.html/</guid>
      <description>

&lt;p&gt;Over the years of doing various levels of web-based programming, I&amp;rsquo;ve come feel like Dante taking a trip through the nine circles of web programmer hell. There are certain things we must endure over and over, from project to project, that seem to take an exorbitant amount of coding to accomplish with little forward progress on the actual project itself. Some of these circles invariably include HTML forms, form validation code, time translation or formatting code, Unicode or encoding code, and, since the dot-com boom, shopping cart/checkout code.&lt;/p&gt;

&lt;p&gt;While the CPAN community has solved most of the problems quite nicely with modules like &lt;a href=&#34;https://metacpan.org/pod/Data::FormValidator&#34;&gt;Data::FormValidator&lt;/a&gt;, &lt;a href=&#34;https://metacpan.org/pod/HTML::FillInForm&#34;&gt;HTML::FillInForm&lt;/a&gt;, &lt;a href=&#34;https://metacpan.org/pod/DateTime&#34;&gt;DateTime&lt;/a&gt;, and the various &lt;code&gt;FromForm&lt;/code&gt;/&lt;code&gt;QuickForm&lt;/code&gt;/&lt;code&gt;FormBuilder&lt;/code&gt; modules, I still yearned for a lightweight, straightforward shopping cart module that didn&amp;rsquo;t involve installed an entire CMS or B2B solution. Thus, Handel.&lt;/p&gt;

&lt;p&gt;Later I will show you how to get a functional shopping cart up and running using no lines of code. You heard that correctly: no lines of code. Zero. None. Nada.&lt;/p&gt;

&lt;h3 id=&#34;what-handel-is&#34;&gt;What Handel Is&lt;/h3&gt;

&lt;p&gt;Handel is a set of modules to perform the repetitive tasks associated with creating a shopping cart and a checkout process on the Web in Perl.&lt;/p&gt;

&lt;p&gt;This includes the usual actions, such as adding items to the cart, updating item quantity, and removing items, as well as less common features, including saving the current contents of the cart to a wish list and restoring wish lists back into the current shopping cart.&lt;/p&gt;

&lt;p&gt;Handel doesn&amp;rsquo;t just provide shopping carts. It has order add/update features, taglib support for AxKit, plugin support for Template Toolkit, and helper support for Catalyst. It also includes a plugin-based checkout processing pipeline where orders are passed through a step-by-step process that (with the right plugins loaded) can do anything from address validation and shipping calculation to credit-card verification and email/fax order confirmations.&lt;/p&gt;

&lt;h3 id=&#34;what-handel-is-not&#34;&gt;What Handel Is Not&lt;/h3&gt;

&lt;p&gt;From the beginning, the two main goals of Handel were to be situation-agnostic and to be a set of building blocks, not an out-of-the-box solution.&lt;/p&gt;

&lt;p&gt;Handel needed to be reusable from the standpoint that it should be able to interact with your shopping cart&amp;rsquo;s contents and process an order from anywhere without rewriting the core set of data/processing code. It should be able to get the cart&amp;rsquo;s contents from within a shell script, from a terminal app, from a web page, or from a web service. E-commerce isn&amp;rsquo;t always just about putting up a website. Many times, there will be both a front-end, web-based system and a back-end, GUI-based application.&lt;/p&gt;

&lt;p&gt;I also decided early on that shopping carts and checkout processes can&amp;rsquo;t possibly be everything for everyone. While there are many things in common (part numbers and prices), every site has different requirements on how to process an order and the steps necessary to place that order. It is for this reason that the checkout process by itself does absolutely nothing, but instead employs the help of plugins to add requirements or features.&lt;/p&gt;

&lt;h3 id=&#34;getting-started&#34;&gt;Getting Started&lt;/h3&gt;

&lt;p&gt;Before you start, you need to have a few things installed from CPAN. These include:&lt;/p&gt;

&lt;ul&gt;
&lt;li&gt;Perl 5.8.1+&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://metacpan.org/pod/Handel&#34;&gt;Handel&lt;/a&gt; 0.26+&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://metacpan.org/pod/Catalyst&#34;&gt;Catalyst&lt;/a&gt; 5.33+&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://metacpan.org/pod/Catalyst::View::TT&#34;&gt;Catalyst::View::TT&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://metacpan.org/pod/HTML::FillInForm&#34;&gt;HTML::FillInForm&lt;/a&gt; 1.04+&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://metacpan.org/pod/Data::FormValidator&#34;&gt;Data::FormValidator&lt;/a&gt; 4.00+&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;https://metacpan.org/pod/DBD::SQLite&#34;&gt;DBD::SQLite&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href=&#34;http://www.sqlite.org/&#34;&gt;&lt;code&gt;sqlite3&lt;/code&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;

&lt;p&gt;&lt;em&gt;Perl 5.8.1 or greater? What about 5.6.x?&lt;/em&gt; Yeah, sorry. While Handel runs on Perl 5.6.1 or greater, Catalyst requires 5.8.1 or newer. That&amp;rsquo;s a good thing. Now upgrade your Perl version! :-)&lt;/p&gt;

&lt;h4 id=&#34;creating-the-database&#34;&gt;Creating the Database&lt;/h4&gt;

&lt;p&gt;First, you must create the database. For the sake of this experiment^H^H^H^Harticle, I use Sqlite. In the real world, you would probably want to use MySQL/PostgreSQL instead.&lt;/p&gt;

&lt;p&gt;Download the &lt;a href=&#34;https://fastapi.metacpan.org/source/CLACO/Handel-1.00014/sql/handel.sqlite.sql&#34;&gt;&lt;em&gt;handel.sqlite.sql&lt;/em&gt;&lt;/a&gt; schema script to your hard drive. Now, in your favorite shell, type the following to create the database:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[claco@cypher ~] $ wget https://fastapi.metacpan.org/source/CLACO/Handel-1.00014/sql/handel.sqlite.sql
handel.sqlite.sql                             100% of 2300  B  115 kBps
[claco@cypher ~] $
[claco@cypher ~] $ sqlite3 handel.db &amp;lt; handel.sqlite.sql
[claco@cypher ~] $
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;This should have created an &lt;code&gt;sqlite&lt;/code&gt; v3 database in your working directory. Remember this file name and location. You&amp;rsquo;re going to need it to set up the DSN.&lt;/p&gt;

&lt;h4 id=&#34;creating-the-application&#34;&gt;Creating the Application&lt;/h4&gt;

&lt;p&gt;If you haven&amp;rsquo;t used or even heard about Catalyst yet, now is probably a good time to read Jesse Sheidlower&amp;rsquo;s article &lt;a href=&#34;http://localhost:1313/pub/2005/06/02/catalyst.html&#34;&gt;introducing the Catalyst MVC framework&lt;/a&gt;. Because Handel isn&amp;rsquo;t bound to any specific front-end GUI, you need to use other tools to interact with the data. For the purposes of this introduction, Catalyst will provide the front-end web interface for use.&lt;/p&gt;

&lt;p&gt;To create the new web application, simply call &lt;em&gt;catalyst.pl&lt;/em&gt;, passing it the name of the new application. Make sure to do this in the directory in which you wish to have the new application&amp;rsquo;s directory created.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;$ catalyst.pl MyStore
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You should end up with output resembling:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[claco@cypher ~] $ catalyst.pl MyStore
created &amp;quot;MyStore&amp;quot;
created &amp;quot;MyStore/script&amp;quot;
created &amp;quot;MyStore/lib&amp;quot;
created &amp;quot;MyStore/root&amp;quot;
created &amp;quot;MyStore/t&amp;quot;
created &amp;quot;MyStore/t/M&amp;quot;
created &amp;quot;MyStore/t/V&amp;quot;
created &amp;quot;MyStore/t/C&amp;quot;
created &amp;quot;MyStore/lib/MyStore&amp;quot;
created &amp;quot;MyStore/lib/MyStore/M&amp;quot;
created &amp;quot;MyStore/lib/MyStore/V&amp;quot;
created &amp;quot;MyStore/lib/MyStore/C&amp;quot;
created &amp;quot;MyStore/lib/MyStore.pm&amp;quot;
created &amp;quot;MyStore/Build.PL&amp;quot;
created &amp;quot;MyStore/Makefile.PL&amp;quot;
created &amp;quot;MyStore/README&amp;quot;
created &amp;quot;MyStore/Changes&amp;quot;
created &amp;quot;MyStore/t/01app.t&amp;quot;
created &amp;quot;MyStore/t/02pod.t&amp;quot;
created &amp;quot;MyStore/t/03podcoverage.t&amp;quot;
created &amp;quot;MyStore/script/mystore_cgi.pl&amp;quot;
created &amp;quot;MyStore/script/mystore_fastcgi.pl&amp;quot;
created &amp;quot;MyStore/script/mystore_server.pl&amp;quot;
created &amp;quot;MyStore/script/mystore_test.pl&amp;quot;
created &amp;quot;MyStore/script/mystore_create.pl&amp;quot;
[claco@cypher ~] $
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now run the newly created application, just to see what you have so far. In your terminal, change directory into the newly created app and start its server:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[claco@cypher ~] $ cd MyStore
[claco@cypher ~/MyStore] $ script/mystore_server.pl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;You should see a bunch of debugging information streaming to the console:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Wed Sep 21 19:19:16 2005] [catalyst] [debug] Debug messages enabled
[Wed Sep 21 19:19:16 2005] [catalyst] [debug] Loaded dispatcher
    &amp;quot;Catalyst::Dispatcher&amp;quot;
[Wed Sep 21 19:19:16 2005] [catalyst] [debug] Loaded engine
    &amp;quot;Catalyst::Engine::HTTP&amp;quot;
[Wed Sep 21 19:19:16 2005] [catalyst] [debug] Found home
    &amp;quot;/usr/home/claco/MyStore&amp;quot;
[Wed Sep 21 19:19:16 2005] [catalyst] [debug] Loaded private actions:
.=-------------------------------------+--------------------------------------=.
| Private                              | Class                                 |
|=-------------------------------------+--------------------------------------=|
| /default                             | MyStore                               |
&#39;=-------------------------------------+--------------------------------------=&#39;

[Wed Sep 21 19:19:16 2005] [catalyst] [info] MyStore powered by Catalyst 5.33
You can connect to your server at http://localhost:3000/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Now point your browser to the address listed in the debug output. This is usually &lt;code&gt;http://localhost:3000/&lt;/code&gt;. If everything is working properly, you should have a nice new shiny web application looking something like Figure 1.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/congratulations.gif&#34; alt=&#34;New MyStore Application Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 1. A NewStore application&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Of course, your new store doesn&amp;rsquo;t do anything yet. :-) It&amp;rsquo;s time to fix that. Stop the application by hitting &lt;code&gt;CTRL-C&lt;/code&gt;.&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;^C
[claco@cypher ~/MyStore] $
&lt;/code&gt;&lt;/pre&gt;

&lt;h4 id=&#34;flip-the-more-magic-switch&#34;&gt;Flip The More Magic Switch&lt;/h4&gt;

&lt;p&gt;Now it&amp;rsquo;s time for the magic. Handel comes with a set of &lt;em&gt;helpers&lt;/em&gt; for Catalyst. A helper is a module that Catalyst loads when running the &lt;em&gt;create.pl&lt;/em&gt; script. The helpers generate TT template files; controller, model, or view modules; and just about anything else you can code into one.&lt;/p&gt;

&lt;p&gt;Because this is a new web application, Handel can create the cart, the checkout process, and the order views using &lt;code&gt;Handel::Scaffold&lt;/code&gt;. &lt;code&gt;Handel::Scaffold&lt;/code&gt; is a meta-helper that uses other individual helpers to get the job done. If you want to add cart/order/checkout features to an existing Catalyst application, use the individual Catalyst helpers to create just the cart or just the checkout functionality.&lt;/p&gt;

&lt;p&gt;Back in the terminal, use MyStore&amp;rsquo;s create script to call &lt;code&gt;Handel::Scaffold&lt;/code&gt;, passing it the DSN for the database created earlier:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[claco@cypher ~/MyStore] $ script/mystore_create.pl Handel::Scaffold \
    dbi:SQLite:dbname=/home/claco/handel.db
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Once again, you will see some output scroll by:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;created &amp;quot;/usr/home/claco/MyStore/script/../lib/MyStore/V/TT.pm&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../t/V/TT.t&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../lib/MyStore/M/Cart.pm&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../t/M/Cart.t&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../lib/MyStore/M/Orders.pm&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../t/M/Orders.t&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/cart&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../lib/MyStore/C/Cart.pm&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/cart/view.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/cart/list.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../t/C/Cart.t&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/orders&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../lib/MyStore/C/Orders.pm&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/orders/list.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/orders/view.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../t/C/Orders.t&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/checkout&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../lib/MyStore/C/Checkout.pm&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/checkout/edit.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/checkout/preview.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/checkout/payment.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../root/checkout/complete.tt&amp;quot;
created &amp;quot;/usr/home/claco/MyStore/script/../t/C/Checkout.t&amp;quot;
[claco@cypher ~/MyStore] $
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;That&amp;rsquo;s it! You now have a shopping cart, an order list/view, and a checkout process framework without writing a single line of code!&lt;/p&gt;

&lt;h3 id=&#34;exploring-the-results&#34;&gt;Exploring the Results&lt;/h3&gt;

&lt;p&gt;I&amp;rsquo;m sure that you want to explore some of the features of your newly created codebase. Start the web application again:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[claco@cypher ~/MyStore] $ script/mystore_server.pl
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;When the application starts this time, there&amp;rsquo;s quite a bit more output:&lt;/p&gt;

&lt;pre&gt;&lt;code&gt;[Wed Sep 21 20:10:04 2005] [catalyst] [debug] Debug messages enabled
[Wed Sep 21 20:10:04 2005] [catalyst] [debug] Loaded dispatcher
    &amp;quot;Catalyst::Dispatcher&amp;quot;
[Wed Sep 21 20:10:04 2005] [catalyst] [debug] Loaded engine
    &amp;quot;Catalyst::Engine::HTTP&amp;quot;
[Wed Sep 21 20:10:04 2005] [catalyst] [debug] Found home
    &amp;quot;/usr/home/claco/MyStore&amp;quot;
[Wed Sep 21 20:10:05 2005] [catalyst] [debug] Loaded components:
.=----------------------------------------------------------------------------=.
| MyStore::C::Cart                                                            |
| MyStore::C::Checkout                                                        |
| MyStore::C::Orders                                                          |
| MyStore::M::Cart                                                            |
| MyStore::M::Orders                                                          |
| MyStore::V::TT                                                              |
&#39;=----------------------------------------------------------------------------=&#39;

[Wed Sep 21 20:10:05 2005] [catalyst] [debug] Loaded private actions:
.=-------------------------------------+--------------------------------------=.
| Private                              | Class                                 |
|=-------------------------------------+--------------------------------------=|
| /default                             | MyStore                               |
| /cart/add                            | MyStore::C::Cart                      |
| /cart/clear                          | MyStore::C::Cart                      |
| /cart/restore                        | MyStore::C::Cart                      |
| /cart/default                        | MyStore::C::Cart                      |
| /cart/end                            | MyStore::C::Cart                      |
| /cart/save                           | MyStore::C::Cart                      |
| /cart/view                           | MyStore::C::Cart                      |
| /cart/delete                         | MyStore::C::Cart                      |
| /cart/empty                          | MyStore::C::Cart                      |
| /cart/begin                          | MyStore::C::Cart                      |
| /cart/destroy                        | MyStore::C::Cart                      |
| /cart/update                         | MyStore::C::Cart                      |
| /cart/list                           | MyStore::C::Cart                      |
| /orders/view                         | MyStore::C::Orders                    |
| /orders/default                      | MyStore::C::Orders                    |
| /orders/begin                        | MyStore::C::Orders                    |
| /orders/list                         | MyStore::C::Orders                    |
| /orders/end                          | MyStore::C::Orders                    |
| /checkout/payment                    | MyStore::C::Checkout                  |
| /checkout/default                    | MyStore::C::Checkout                  |
| /checkout/edit                       | MyStore::C::Checkout                  |
| /checkout/end                        | MyStore::C::Checkout                  |
| /checkout/preview                    | MyStore::C::Checkout                  |
| /checkout/begin                      | MyStore::C::Checkout                  |
| /checkout/update                     | MyStore::C::Checkout                  |
| /checkout/complete                   | MyStore::C::Checkout                  |
&#39;=-------------------------------------+--------------------------------------=&#39;

[Wed Sep 21 20:10:05 2005] [catalyst] [debug] Loaded public actions:
.=-------------------------------------+--------------------------------------=.
| Public                               | Private                               |
|=-------------------------------------+--------------------------------------=|
| /cart/add                            | /cart/add                             |
| /cart/clear                          | /cart/clear                           |
| /cart/delete                         | /cart/delete                          |
| /cart/destroy                        | /cart/destroy                         |
| /cart/empty                          | /cart/empty                           |
| /cart/list                           | /cart/list                            |
| /cart/restore                        | /cart/restore                         |
| /cart/save                           | /cart/save                            |
| /cart/update                         | /cart/update                          |
| /cart/view                           | /cart/view                            |
| /checkout/complete                   | /checkout/complete                    |
| /checkout/default                    | /checkout/default                     |
| /checkout/edit                       | /checkout/edit                        |
| /checkout/payment                    | /checkout/payment                     |
| /checkout/preview                    | /checkout/preview                     |
| /checkout/update                     | /checkout/update                      |
| /orders/list                         | /orders/list                          |
| /orders/view                         | /orders/view                          |
&#39;=-------------------------------------+--------------------------------------=&#39;

[Wed Sep 21 20:10:05 2005] [catalyst] [info] MyStore powered by Catalyst 5.33
You can connect to your server at http://localhost:3000/
&lt;/code&gt;&lt;/pre&gt;

&lt;p&gt;Cart, orders, checkout. Oh my!&lt;/p&gt;

&lt;h4 id=&#34;the-shopping-cart&#34;&gt;The Shopping Cart&lt;/h4&gt;

&lt;p&gt;The shopping cart code base includes the usual actions: add, update, delete, and empty, as well as the ability to save the cart&amp;rsquo;s contents and restore a saved cart back into the current cart. To try it out, you need to add something to the cart!&lt;/p&gt;

&lt;p&gt;Download the &lt;a href=&#34;http://localhost:1313/media/_pub_2005_11_17_handel/products.html&#34;&gt;test products page&lt;/a&gt; and load it in a browser of your choice (Figure 2).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/products.gif&#34; alt=&#34;Product Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 2. The product page&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Once you load the page, pick a hot new product and click Add To Cart (Figure 3). By default, the product&amp;rsquo;s page points to &lt;em&gt;&lt;a href=&#34;http://localhost:3000/cart/&#34;&gt;http://localhost:3000/cart/&lt;/a&gt;&lt;/em&gt;. You may have to alter the page&amp;rsquo;s contents to match the address of the MyStore server.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/cart.gif&#34; alt=&#34;Shopping Cart Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 3. The shopping cart page&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Save this cart. Hit the Save Cart button and leave the field next to it blank.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/cartsaveerror.gif&#34; alt=&#34;Cart Save Error Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 4. The shopping cart with an error&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Take note of the error at the top of the page in Figure 4&amp;ndash;&amp;ldquo;The Name field is required to save a cart.&amp;rdquo; The code and template generated by Handel uses &lt;code&gt;Data::FormValidator&lt;/code&gt; and &lt;code&gt;HTML::FillInForm&lt;/code&gt; where appropriate. Not only didn&amp;rsquo;t you have to write any cart code, you didn&amp;rsquo;t have to write and forms validation code either!&lt;/p&gt;

&lt;p&gt;Go ahead and enter a name for your saved cart and hit Save Cart again. If all goes well, Handel saves the shopping cart&amp;rsquo;s contents into a list under the name specified in the &lt;code&gt;Name&lt;/code&gt; field. To view the list of saved shopping carts, click View Saved Carts at the top of the page (Figure 5).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/savedcarts.gif&#34; alt=&#34;Saved Carts Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 5. Viewing saved carts&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;When restoring wish lists, there are three options: Append, Merge, and Replace. As the titles imply, Append simply adds the saved cart items to the current cart. There is no attempt made to prevent duplicate parts. Merge adds the saved cart&amp;rsquo;s contents into the current cart. If it finds a part with the same identifier, it adds the quantity of the two parts together. Replace empties the current cart and them restores the saved cart&amp;rsquo;s contents.&lt;/p&gt;

&lt;p&gt;Because the cart is currently empty, select any of those methods and hit Restore Cart. You should be back at the cart page with your cart items restored.&lt;/p&gt;

&lt;h4 id=&#34;checkout&#34;&gt;Checkout&lt;/h4&gt;

&lt;p&gt;On the cart page, hit the Checkout button. This will take you to the BillTo/ShipTo edit screen (Figure 6).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/billship.gif&#34; alt=&#34;BillTo/ShipTo Edit Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 6. The BillTo/ShipTo page&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;In either of the first name fields, enter your first name. Scroll to the bottom of the page and click Continue. If everything is working correctly, you should see a page resembling Figure 7.&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/billshiperror.gif&#34; alt=&#34;BillTo/ShipTo Error Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 7. An error in billing/shipping&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;Once again, the generated code from Handel has taken care of validating required form fields for you and the fill-in forms kept the data you entered, all without writing any code. (Noticing a theme yet?)&lt;/p&gt;

&lt;p&gt;Take some time on your own to work your way through the rest of the checkout process. This includes a preview page, the credit card payment page, and an order completion page. Once you&amp;rsquo;ve completed your order, you should receive a &amp;ldquo;thank you&amp;rdquo; page with links to view all of your orders (Figure 8).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/complete.gif&#34; alt=&#34;Order Complete Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 8. The Order Complete page&lt;/em&gt;&lt;/p&gt;

&lt;h4 id=&#34;orders-list&#34;&gt;Orders List&lt;/h4&gt;

&lt;p&gt;Last but not least, check out the orders list. On your order completion screen, click on the View Orders link. Here you will find a list of any orders you have placed (Figure 9). Click the View Order link next to any order for more details about that order (Figure 10).&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/orderlist.gif&#34; alt=&#34;Orders List Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 9. The Orders List page.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;img src=&#34;http://localhost:1313/images/_pub_2005_11_17_handel/vieworder.gif&#34; alt=&#34;Order Details Page Screenshot&#34; width=&#34;500&#34; height=&#34;353&#34; /&gt;
&lt;em&gt;Figure 10. The order details page&lt;/em&gt;&lt;/p&gt;

&lt;h3 id=&#34;where-to-go-from-here&#34;&gt;Where To Go From Here&lt;/h3&gt;

&lt;p&gt;As you&amp;rsquo;ve hopefully seen in the article, by combining the powers of Handel and Catalyst, you need not suffer through the dreary task of writing another shopping cart from scratch ever again. With the plugin architecture Handel provides, you will find that you can do even the more complicated checkout tasks using nothing more than a few lines of code to glue various business modules into plugins.&lt;/p&gt;

&lt;p&gt;With Handel as the core, we can look forward to new and improved Perl-based E-commerce solutions and new ways to add E-commerce features to existing projects without having to reinvent the wheel&amp;ndash;again!&lt;/p&gt;
</description>
    </item>
    
  </channel>
</rss>

