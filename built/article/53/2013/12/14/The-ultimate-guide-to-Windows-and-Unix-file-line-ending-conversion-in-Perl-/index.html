<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title> The ultimate guide to Windows and Unix file line ending conversion in Perl  </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Think you know how to fix CRLF in one line of Perl? There might be more to it than you think ..."/>
  <meta name="robots" content="index, follow">
  <meta name="google-site-verification" content="TZowffo_LX2mmsw2DbeNNbukCMnIOA8T-6CMJPiYllI" />

<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@PerlFoundation">
<meta property="og:url" content="http://localhost:1313/article/53/2013/12/14/The-ultimate-guide-to-Windows-and-Unix-file-line-ending-conversion-in-Perl-/" />
<meta property="og:title" content="The ultimate guide to Windows and Unix file line ending conversion in Perl " />
<meta property="og:description" content="Think you know how to fix CRLF in one line of Perl? There might be more to it than you think ...">
<meta property="og:site_name" content="Perl.com" />

<meta property="og:type" content="article" />
<meta property="og:article:published_time" content="2013-12-12T12:12:12Z" />
<meta property="og:image" content="http://localhost:1313/images/author/david-farrell.jpg" />
<meta property="og:article:tag" content="file" />
<meta property="og:article:tag" content="linux" />
<meta property="og:article:tag" content="windows" />
<meta property="og:article:tag" content="powershell" />
<meta property="og:article:tag" content="bash" />
<meta property="og:article:tag" content="crlf" />
<meta property="og:article:tag" content="osx" />


  <link rel="icon" href="/favicon.ico">
  <link href="/article/index.xml" rel="alternate" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/article/index.xml" rel="feed" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/css/perldotcom.css"/>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50555-22', 'auto');
ga('create', 'UA-85734801-2', 'auto', 'editor');
ga('send', 'pageview');
ga('editor.send', 'pageview');
</script>

</head>
<body>

<div class="container-fluid full-wdith antonio">
 <div class="row">
  <div class="navbar-inverse" style="border-radius:none !important" role="navigation">
    <div class="container-fluid">
      <ul class="nav navbar-nav pull-right follow">
          <li>MORE:</li>
          <li><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a><li>
          <li><a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a><li>
          <li><a href="/article/index.xml" />
              <img src="/images/site/rss_20.png" alt="rss"></a></li>
          <li><a href="https://github.com/tpf/perldotcom" />
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></li>
      </ul>
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          <a class="navbar-nav" href="/">
            <div class="header-logo">Perl.com</div>
          </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/about">
              <div class="circle">
                <img src="/images/site/perl-camel.png" alt="" />
              </div>
                  &nbsp;&nbsp;ABOUT</a>
          </li>
          <li><a href="/authors">
              <div class="circle">
                  <span class="glyphicon glyphicon-user txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;AUTHORS</a>
          </li>
          <li><a href="/categories">
              <div class="circle">
                  <span class="glyphicon glyphicon-folder-open txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;CATEGORIES</a>
          </li>
          <li><a href="/tags">
              <div class="circle">
                <span class="txt-blue-major" aria-hidden="true"><strong>#</strong></span>
              </div>
                  &nbsp;&nbsp;TAGS</a>
          </li>
          <li>
            <form class="search" name="ddg" action="https://duckduckgo.com/" method="get">
              <input type="text" name ="q" placeholder="SEARCH" />
              <input type="hidden" value="perl.com" name="sites" />
            </form>
          </li>
        </ul>
      </div>
    </div>
  </div>
 </div>
</div>


  <section id="content" role="main">
    <section class="entry-content">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <article class="fulltext">
              <h1 class="blog-post-title">The ultimate guide to Windows and Unix file line ending conversion in Perl </h1>
              <p class="blog-post-meta">Dec 14, 2013 by
              
              
                
                
                <a href="#author-bio-david-farrell">David Farrell</a>
              
              </p>
              <img alt="" src=""/>
                

<p><em>Most programmers know that the file line endings used by Windows and Unix-based systems are different. Windows uses CRLF and the Unix-based systems use LF. So fixing this is in Perl requires a simple substitution regex right? Not so fast &hellip;</em></p>

<h3 id="requirements">Requirements</h3>

<p>You must be using Perl version 5.14 or greater.</p>

<h3 id="conversion-on-unix-based-systems">Conversion on Unix-based systems</h3>

<p>These are easy. To convert a file to Unix-style line endings (as used by Linux, BSD, OSX) just open up the terminal and run:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#f92672">-</span>pi<span style="color:#f92672">.</span>bak <span style="color:#f92672">-</span>e <span style="color:#e6db74">&#39;s/\R/\012/&#39;</span> <span style="color:#e6db74">/path/</span>to<span style="color:#f92672">/</span>file</code></pre></div>
<p>This code works by replacing any line break characters (&rdquo;\R&rdquo;) with a single line feed character (&rdquo;\012&rdquo;). The &ldquo;\R&rdquo; meta-character is available in Perl from version 5.10 onwards, it&rsquo;s useful because it will even work for files with mixed line ending styles. The in-place switch (&ldquo;i&rdquo;) creates a backup of the original file with the extension &ldquo;.bak&rdquo;. To convert a file from Unix to Windows-style line endings, use this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#f92672">-</span>pi<span style="color:#f92672">.</span>bak <span style="color:#f92672">-</span>e <span style="color:#e6db74">&#39;s/\R/\015\012/&#39;</span> <span style="color:#e6db74">/path/</span>to<span style="color:#f92672">/</span>file</code></pre></div>
<p>This replaces any vertical character with the CRLF (&rdquo;\015\012&rdquo;) line ending used by Windows. Again, this will also work for files with a mix of Unix and Windows line endings.</p>

<h3 id="conversion-on-windows">Conversion on Windows</h3>

<p>Things are trickier on Windows; there are a few things to be aware of:</p>

<ul>
<li>By default Perl changes the value of &ldquo;\n&rdquo; to CRLF. This means that the regex match: &ldquo;/\015\012/&rdquo; will fail on Windows as Perl is actually running: &ldquo;/\015\015\012/&ldquo;. Regexes using meta-characters and hex codes (&rdquo;/\r\n/&rdquo; and &ldquo;/\x0d\x0a/&ldquo;) fail for the same reason.</li>
<li>Single-quotes must be replaced with double-quotes to enclose the code in &ldquo;e&rdquo; and quoting operators must be used when single quotes are required within the code (e.g. &ldquo;q||&rdquo;)</li>
<li>The in-place switch (&ldquo;i&rdquo;) works, but any extension (e.g. &ldquo;.bak&rdquo;) will change the file ending and the default programs associated with it. The examples below use alternative methods.</li>
</ul>

<p>If you&rsquo;re using cmd.exe or PowerShell the following Perl one liner will convert a file to Windows-style line endings:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#f92672">-</span>pe <span style="color:#e6db74">&#34;binmode(STDOUT);s/\R/\015\012/&#34;</span> <span style="color:#e6db74">/path/</span>to<span style="color:#e6db74">/file &gt; /</span>path<span style="color:#e6db74">/to/</span><span style="color:#66d9ef">new</span><span style="color:#f92672">/</span>file</code></pre></div>
<p>The main differences here are: replacing single-quotes with double-quotes, &ldquo;binmode(STDOUT)&rdquo; to turn off Perl&rsquo;s CRLF line endings and the use of redirect &ldquo;&gt;&rdquo; to write the contents to a different file, instead of using the in-place switch. To convert a file to Unix-style line endings on cmd.exe this will work:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#f92672">-</span>pe <span style="color:#e6db74">&#34;binmode(STDOUT);s/\R/\012/&#34;</span> <span style="color:#e6db74">/path/</span>to<span style="color:#e6db74">/file &gt; /</span>path<span style="color:#e6db74">/to/</span><span style="color:#66d9ef">new</span><span style="color:#f92672">/</span>file</code></pre></div>
<p>On PowerShell a few more changes are required. To convert to Unix-style line endings use:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#f92672">-</span><span style="color:#f92672">ne</span> <span style="color:#e6db74">&#34;open(OUT, q(&gt;&gt;), q(/path/to/new/file));binmode(OUT);print OUT s/\R/\012/r&#34;</span> <span style="color:#e6db74">/path/</span>to<span style="color:#f92672">/</span>file</code></pre></div>
<p>So what just happened there? First of all we changed the command line switch &ldquo;p&rdquo; to &ldquo;n&rdquo;. This stops Perl from printing every line it processes to standard output. Instead we opened an appending filehandle &ldquo;OUT&rdquo; to our output file and printed the result ourselves. The reason we had to do this was that PowerShell automatically interprets standard output as Unicode and replaces Unix-style endings with Windows CRLF endings. Hence using the re-direct method (&rdquo;&gt;&rdquo;) does not work. And before you try, piping the output like this generates an error:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-perl" data-lang="perl">perl <span style="color:#f92672">-</span>pe <span style="color:#e6db74">&#34;binmode(STDOUT);s/\R/\012/r&#34;</span> <span style="color:#e6db74">/path/</span>to<span style="color:#e6db74">/file | set-content /</span>path<span style="color:#e6db74">/to/</span><span style="color:#66d9ef">new</span><span style="color:#f92672">/</span>file <span style="color:#f92672">-</span>Encoding Byte</code></pre></div>
<p>We also had to use the quoting operator (&ldquo;q()&rdquo;) to quote our content instead of using single quotes. Finally, the substitution regex (&ldquo;s/\R/\012/&ldquo;) was changed to use the &ldquo;r&rdquo; modifier, which returns the result of the substitution without modifying the original variable. This feature is available from Perl version 5.14 onwards.</p>

<h3 id="further-reading">Further Reading</h3>

<p>Perl&rsquo;s offical documentation &ldquo;perlrun&rdquo; entry has a lot of detail on Perl&rsquo;s command line switches. Access it <a href="https://perldoc.perl.org/perlrun.html">online</a> or at the command line by typing: &ldquo;perldoc perlrun&rdquo;</p>

<p>Peteris Krummins&rsquo; <a href="http://www.catonmat.net/">website</a> provides loads of Perl one liners. His new book <a href="http://www.amazon.com/gp/product/159327520X/ref=as_li_qf_sp_asin_tl?ie=UTF8&amp;camp=1789&amp;creative=9325&amp;creativeASIN=159327520X&amp;linkCode=as2&amp;tag=perltrickscom-20">Perl One-Liners: 130 Programs That Get Things Done</a> has just been published (affiliate link). It contains many useful one liners, but also 9 pages of detailed guidance on running one liners on Windows - highly recommended!</p>

<p><br />
<em>This article was originally posted on <a href="http://perltricks.com">PerlTricks.com</a>.</em></p>

              </article>
              <p><strong>Tags</strong></p>
              <div class="tags">
                <div class="category"><a href="/categories/development">development</a></div>
                
                  <div class="tag"><a href="/tags/file">file</a></div>
                
                  <div class="tag"><a href="/tags/linux">linux</a></div>
                
                  <div class="tag"><a href="/tags/windows">windows</a></div>
                
                  <div class="tag"><a href="/tags/powershell">powershell</a></div>
                
                  <div class="tag"><a href="/tags/bash">bash</a></div>
                
                  <div class="tag"><a href="/tags/crlf">crlf</a></div>
                
                  <div class="tag"><a href="/tags/osx">osx</a></div>
                
              </div>
            </div>
            
              
                
<div class="row" id="author-bio-david-farrell">
  <div class="col-sm-2">
    
    <a href="/authors/david-farrell/"><div class="circle-avatar" style="background-image:url(/images/author/david-farrell.jpg)"></div></a>
  </div>
  <div class="col-sm-10">
    <a href="/authors/david-farrell/"><h3>David Farrell</h3></a>
    <p>David is the editor of Perl.com. An organizer of the <a href="http://www.meetup.com/The-New-York-Perl-Meetup-Group/">New York Perl Meetup</a>, he works for ZipRecruiter as a software developer, and sometimes <a href="https://twitter.com/perltricks">tweets</a> about Perl and Open Source.</p>
    <h5><a href="/authors/david-farrell/">Browse their articles</a></h5>
  </div>
</div>

            
            <div class="row">
              <h3>Feedback</h3>
              <p>Something wrong with this article? Help us out by opening an issue or pull request on <a href="https://github.com/tpf/perldotcom/blob/master/content/article/the-ultimate-guide-to-windows-and-unix-file-line-ending-conversion-in-perl-.md">GitHub</a></p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="latest-sidebar">

  <div class="row">
    <div class="col-sm-12 centering">
      <span style="font-size:1.8em" class="antonio txt-blue-major">OUR LATEST ARTICLES</span>
    </div>
  </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/the-perl-admbassador-curtis-poe/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/the-perl-ambassador-curtis-poe/curtis-poe.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>The Perl Ambassador: Curtis &#39;Ovid&#39; Poe</h6>
          <p style="line-height:1"><small>The person behind the news of Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/a-tour-with-net-ftp/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/a-tour-with-net-ftp/thumb_kidyes.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>A tour with Net::FTP</h6>
          <p style="line-height:1"><small>How to write an FTP client in Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/shortcode_test/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/author/brian-d-foy.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>shortcode_test</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/thumb_larry-wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Listen to Larry Wall&#39;s State of the Onion 2000 on YouTube</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/announcing-perl-7/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/announcing-perl-7/thumb_seven_on_blue_wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Announcing Perl 7</h6>
          <p style="line-height:1"><small>Perl 5 with modern defaults</small></p>
      </div>
        </a>
    </div>
  
</div>
<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
  <script async src="/widget/toplinks/toplinks.js" type="text/javascript"></script>
    <div id="toplinks"></div>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <a class="twitter-timeline" data-height="640" data-dnt="true" data-theme="dark" href="https://twitter.com/perlfoundation?ref_src=twsrc%5Etfw">Tweets by perlfoundation</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <script src="https://www.reddit.com/r/perl/hot/.embed?limit=10&t=all" type="text/javascript"></script>
  </div>
</div>



          </div>
        </div>
      </div>
    </section>
  </section>
<script>
 
var tables, i;
tables = document.getElementsByTagName('table');
for (i=0;i<tables.length;i++) {
  tables[i].className = 'table table-striped';
}
</script>
<div class="push"></div>
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <h5>Site Map</h5>
        <ul>
        <li><a href="/">Home</a></li>
        <hr>
        <li><a href="/about">About</a></li>
        <hr>
        <li><a href="/authors">Authors</a></li>
        <hr>
        <li><a href="/categories">Categories</a></li>
        <hr>
        <li><a href="/tags">Tags</a></li>
        <hr>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Contact Us</h5>
        <p>To get in touch, send an email to: perl.com-editor@perl.org</p>
        <p><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a>
          <a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a>
          <a href="/index.xml" /><img src="/images/site/rss_20.png" alt="rss"></a>
          <a href="https://github.com/tpf/perldotcom">
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></p>
      </div>
      <div class="col-md-2">
          <h5>License</h5>
          <p>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</p>
          <p><a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/3.0/88x31.png" /></a></p>
      </div>
      <div class="col-md-5">
          <h5>Legal</h5>
          <p>Perl.com and the authors make no representations with respect to the accuracy or completeness of the contents of all work on this website and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. The information published on this website may not be suitable for every situation. All work on this website is provided with the understanding that Perl.com and the authors are not engaged in rendering professional services. Neither Perl.com nor the authors shall be liable for damages arising herefrom.</p>
      </div>
    </div>
  </div>
</div>
<script src="/javascript/jquery.min.js"></script>
<script src="/javascript/bootstrap.min.js"></script>
<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10"></' + 'script>')</script></body>
</html>

