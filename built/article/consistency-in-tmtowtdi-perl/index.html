<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title> Consistency in TMTOWTDI Perl </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content="Some tips for improving consistency in shared Perl codebases"/>
  <meta name="robots" content="index, follow">
  <meta name="google-site-verification" content="TZowffo_LX2mmsw2DbeNNbukCMnIOA8T-6CMJPiYllI" />

<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@PerlFoundation">
<meta property="og:url" content="http://localhost:1313/article/consistency-in-tmtowtdi-perl/" />
<meta property="og:title" content="Consistency in TMTOWTDI Perl" />
<meta property="og:description" content="Some tips for improving consistency in shared Perl codebases">
<meta property="og:site_name" content="Perl.com" />

<meta property="og:type" content="article" />
<meta property="og:article:published_time" content="2019-04-04T04:04:04Z" />
<meta property="og:image" content="http://localhost:1313/images/site/avatar.png" />
<meta property="og:article:tag" content="git" />
<meta property="og:article:tag" content="perlcritic" />
<meta property="og:article:tag" content="perltidy" />


  <link rel="icon" href="/favicon.ico">
  <link href="/article/index.xml" rel="alternate" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/article/index.xml" rel="feed" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/css/perldotcom.css"/>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50555-22', 'auto');
ga('create', 'UA-85734801-2', 'auto', 'editor');
ga('send', 'pageview');
ga('editor.send', 'pageview');
</script>

</head>
<body>

<div class="container-fluid full-wdith antonio">
 <div class="row">
  <div class="navbar-inverse" style="border-radius:none !important" role="navigation">
    <div class="container-fluid">
      <ul class="nav navbar-nav pull-right follow">
          <li>MORE:</li>
          <li><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a><li>
          <li><a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a><li>
          <li><a href="/article/index.xml" />
              <img src="/images/site/rss_20.png" alt="rss"></a></li>
          <li><a href="https://github.com/tpf/perldotcom" />
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></li>
      </ul>
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          <a class="navbar-nav" href="/">
            <div class="header-logo">Perl.com</div>
          </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/about">
              <div class="circle">
                <img src="/images/site/perl-camel.png" alt="" />
              </div>
                  &nbsp;&nbsp;ABOUT</a>
          </li>
          <li><a href="/authors">
              <div class="circle">
                  <span class="glyphicon glyphicon-user txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;AUTHORS</a>
          </li>
          <li><a href="/categories">
              <div class="circle">
                  <span class="glyphicon glyphicon-folder-open txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;CATEGORIES</a>
          </li>
          <li><a href="/tags">
              <div class="circle">
                <span class="txt-blue-major" aria-hidden="true"><strong>#</strong></span>
              </div>
                  &nbsp;&nbsp;TAGS</a>
          </li>
          <li>
            <form class="search" name="ddg" action="https://duckduckgo.com/" method="get">
              <input type="text" name ="q" placeholder="SEARCH" />
              <input type="hidden" value="perl.com" name="sites" />
            </form>
          </li>
        </ul>
      </div>
    </div>
  </div>
 </div>
</div>


  <section id="content" role="main">
    <section class="entry-content">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <article class="fulltext">
              <h1 class="blog-post-title">Consistency in TMTOWTDI Perl</h1>
              <p class="blog-post-meta">Apr 8, 2019 by
              
              
                
                
                <a href="#author-bio-alexandru-strajeriu">Alexandru Strajeriu</a>
              
              </p>
              <img alt="" src=""/>
                

<p>As a Perl developer I have a lot of freedom. TMTOWTDI (There&rsquo;s More Than One Way To Do It) allows me to code how I want to code. I can solve a problem using whatever method I feel works best, whatever works for me. That&rsquo;s a cool thing to have, but at the same time, after working on someone else&rsquo;s code for a while and hating the experience, I can understand TMTOWTDIBSCINABTE (There&rsquo;s More Than One Way To Do It, But Sometimes Consistency Is Not A Bad Thing Either) better as a principle.</p>

<p>I&rsquo;ve been coding in Perl for about 9 years. I&rsquo;ve been around the block a few times, at Evozon we work on a few legacy projects, so I&rsquo;ve seen my fair share of code that makes me a proponent of always coding for the maintainer.</p>

<p>There&rsquo;s a quote floating around the internet for quite some time now, that sums up things pretty well.</p>

<blockquote>
<p>Always code as if the guy who ends up maintaining your code will be a violent psychopath who knows where you live.</p>
</blockquote>

<p>I&rsquo;m not going to lie, I&rsquo;ve been in a few situations where knowing the person who coded the monstrosity that I had to handle would have resulted in some very bad decisions on my part.</p>

<p>Freedom is great, consistency is better. It&rsquo;s better for you, when you end up working on your own code in a year, it&rsquo;s better for your team and it&rsquo;s better for whoever else will end up working on that project in the future.</p>

<p>When you&rsquo;re involved in a project that has multiple developers you will have different ideas and different ways of writing code. I work in a cross-functional team of more than 20 people and for consistent code, we use some small tricks that keeps the code easy to maintain - and us happy. Consistent code improves code quality and eliminates some potential bugs.</p>

<p>My recommendation is to use a git pre-commit hook that runs <a href="https://metacpan.org/pod/Perl::Critic">Perl::Critic</a> and <a href="https://metacpan.org/pod/perltidy">perltidy</a>. The latter might be more cosmetic than anything else, but I find it helpful. I know that there are other possible tools, but I think that these three are a good combination to use, in order to have practical coding standards and consistent-looking code.</p>

<h2 id="set-up-perl-critic-and-perl-tidy">Set Up Perl::Critic and Perl::Tidy</h2>

<p>You can install <a href="https://metacpan.org/pod/Perl::Critic">Perl::Critic</a> and <a href="{{ mcpan &quot;Perl::Tidy&quot; &gt;}}">Perl::Tidy</a> from CPAN or they might be available on your package manager. Once installed, you&rsquo;ll need to configure them.</p>

<p>For <code>.perlcriticrc</code> my suggestion is to start with the following configuration:</p>

<pre><code>severity = 5
verbose = %f: [%p] %m at line %l, column %c (Severity %s).\n%d\n
</code></pre>

<p>These options are described in the Perl::Critic <a href="https://metacpan.org/pod/Perl::Critic#CONFIGURATION">documentation</a>.</p>

<p>This is a basic configuration, which you can build upon based on your project and team needs. Increasing the severity might block simple changes from being commited, but in the long run makes your codebase more readable and easier to use.</p>

<p>For <code>.perltidyrc</code> I would suggest to have a team discussion to determine the following items:</p>

<ul>
<li>brace styling</li>
<li>length of lines (my suggestions is to have it at least 120 characters, but I know there are many people that still like it at 80),</li>
<li>number of spaces or tabs per indentation</li>
<li>whatever else you think that your team needs</li>
</ul>

<p>Here is an example with my file:</p>

<pre><code>-i=4
-ci=4
-bar
-ce
-nsbl
-cti=0
-sct
-sot
-pt=0
-sbt=1
-bt=1
-bbt=0
-nsfs
-nolq
-l=120
</code></pre>

<p>These are described in the Perl::Tidy <a href="https://metacpan.org/pod/distribution/Perl-Tidy/bin/perltidy#FORMATTING-OPTIONS">documentation</a>.</p>

<p>Commit both <code>.perlcriticrc</code> and <code>.perltidyrc</code> to your repo.</p>

<h2 id="set-up-the-git-pre-commit-hook">Set Up the Git Pre-commit Hook</h2>

<p>For existing projects, you&rsquo;ll want to run perlcritic and perltidy on all existing files <em>before</em> creating this pre-commit hook, fixing any files which don&rsquo;t pass perlcritic or break perltidy. This is so that each subsequent commit will only be critiqued and tidied on the changes contained in the commit.</p>

<p>To setup the pre-commit hook, create the file <code>.git/hooks/pre-commit</code> in your root project directory. This file will be executed every time you type the <code>git commit</code> command and ru on the files included in the commit.</p>

<p>The file is a shell script:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e">#!/usr/bin/sh
</span><span style="color:#75715e"></span>files_commit<span style="color:#f92672">=</span><span style="color:#66d9ef">$(</span>git diff --cached --name-only<span style="color:#66d9ef">)</span>

<span style="color:#66d9ef">for</span> file in $files_commit; <span style="color:#66d9ef">do</span>
    <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> $file <span style="color:#f92672">=</span>~ pm|pl$ <span style="color:#f92672">]]</span>
    <span style="color:#66d9ef">then</span>
        <span style="color:#75715e">#run perlcritic first so that we avoid unnecessary tidying
</span><span style="color:#75715e"></span>        <span style="color:#66d9ef">if</span> ! <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>perlcritic $file<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> <span style="color:#f92672">=</span>~ <span style="color:#e6db74">&#39;source OK&#39;</span>  <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
            echo &gt;&amp;<span style="color:#ae81ff">2</span> <span style="color:#e6db74">&#34;There was some error when running perlcritic on </span>$file<span style="color:#e6db74">: </span><span style="color:#66d9ef">$(</span>perlcritic $file<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span>
            exit <span style="color:#ae81ff">1</span>
        <span style="color:#66d9ef">fi</span>

        <span style="color:#66d9ef">if</span> <span style="color:#f92672">[[</span> <span style="color:#e6db74">&#34;</span><span style="color:#66d9ef">$(</span>perltidy -b -bext<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;/bk&#39;</span> $file<span style="color:#66d9ef">)</span><span style="color:#e6db74">&#34;</span> -gt <span style="color:#ae81ff">0</span> <span style="color:#f92672">]]</span>; <span style="color:#66d9ef">then</span>
         echo &gt;&amp;<span style="color:#ae81ff">2</span> <span style="color:#e6db74">&#34;There was an error when running perltidy on </span>$file<span style="color:#e6db74">; please see the error file for more info&#34;</span>
           exit <span style="color:#ae81ff">1</span>
       <span style="color:#66d9ef">fi</span>
    <span style="color:#66d9ef">fi</span>
<span style="color:#66d9ef">done</span>

git add $files_commit</code></pre></div>
<p>For every file being committed, this code first runs perlcritic - if it reports a problem, then the script exits, canceling the commit. If perlcritic passes, then it runs perltidy on the same file, and if perltidy exits with an error, then it also aborts the commit. In this example, I am checking only for .pm and .pl files, you can add other type of files there too, like test files, pod files and so on.</p>

<p>I know that this won&rsquo;t solve every problem, but I think combining Perl::Critic and Perl::Tidy and running them automatically is good step towards having a consistent and readable codebase.</p>

              </article>
              <p><strong>Tags</strong></p>
              <div class="tags">
                <div class="category"><a href="/categories/development">development</a></div>
                
                  <div class="tag"><a href="/tags/git">git</a></div>
                
                  <div class="tag"><a href="/tags/perlcritic">perlcritic</a></div>
                
                  <div class="tag"><a href="/tags/perltidy">perltidy</a></div>
                
              </div>
            </div>
            
              
                
<div class="row" id="author-bio-alexandru-strajeriu">
  <div class="col-sm-2">
    
    <a href="/authors/alexandru-strajeriu/"><div class="circle-avatar" style="background-image:url(/images/site/avatar.png)"></div></a>
  </div>
  <div class="col-sm-10">
    <a href="/authors/alexandru-strajeriu/"><h3>Alexandru Strajeriu</h3></a>
    <p>Alex is a Perl developer at <a href="https://www.evozon.com/">Evozon</a>, a software company based in Romania. He’s been working in Perl for 9 years.</p>
    <h5><a href="/authors/alexandru-strajeriu/">Browse their articles</a></h5>
  </div>
</div>

            
            <div class="row">
              <h3>Feedback</h3>
              <p>Something wrong with this article? Help us out by opening an issue or pull request on <a href="https://github.com/tpf/perldotcom/blob/master/content/article/consistency-in-tmtowtdi-perl.md">GitHub</a></p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="latest-sidebar">

  <div class="row">
    <div class="col-sm-12 centering">
      <span style="font-size:1.8em" class="antonio txt-blue-major">OUR LATEST ARTICLES</span>
    </div>
  </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/the-perl-admbassador-curtis-poe/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/the-perl-ambassador-curtis-poe/curtis-poe.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>The Perl Ambassador: Curtis &#39;Ovid&#39; Poe</h6>
          <p style="line-height:1"><small>The person behind the news of Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/a-tour-with-net-ftp/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/a-tour-with-net-ftp/thumb_kidyes.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>A tour with Net::FTP</h6>
          <p style="line-height:1"><small>How to write an FTP client in Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/shortcode_test/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/author/brian-d-foy.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>shortcode_test</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/thumb_larry-wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Listen to Larry Wall&#39;s State of the Onion 2000 on YouTube</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/announcing-perl-7/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/announcing-perl-7/thumb_seven_on_blue_wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Announcing Perl 7</h6>
          <p style="line-height:1"><small>Perl 5 with modern defaults</small></p>
      </div>
        </a>
    </div>
  
</div>
<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
  <script async src="/widget/toplinks/toplinks.js" type="text/javascript"></script>
    <div id="toplinks"></div>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <a class="twitter-timeline" data-height="640" data-dnt="true" data-theme="dark" href="https://twitter.com/perlfoundation?ref_src=twsrc%5Etfw">Tweets by perlfoundation</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <script src="https://www.reddit.com/r/perl/hot/.embed?limit=10&t=all" type="text/javascript"></script>
  </div>
</div>



          </div>
        </div>
      </div>
    </section>
  </section>
<script>
 
var tables, i;
tables = document.getElementsByTagName('table');
for (i=0;i<tables.length;i++) {
  tables[i].className = 'table table-striped';
}
</script>
<div class="push"></div>
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <h5>Site Map</h5>
        <ul>
        <li><a href="/">Home</a></li>
        <hr>
        <li><a href="/about">About</a></li>
        <hr>
        <li><a href="/authors">Authors</a></li>
        <hr>
        <li><a href="/categories">Categories</a></li>
        <hr>
        <li><a href="/tags">Tags</a></li>
        <hr>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Contact Us</h5>
        <p>To get in touch, send an email to: perl.com-editor@perl.org</p>
        <p><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a>
          <a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a>
          <a href="/index.xml" /><img src="/images/site/rss_20.png" alt="rss"></a>
          <a href="https://github.com/tpf/perldotcom">
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></p>
      </div>
      <div class="col-md-2">
          <h5>License</h5>
          <p>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</p>
          <p><a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/3.0/88x31.png" /></a></p>
      </div>
      <div class="col-md-5">
          <h5>Legal</h5>
          <p>Perl.com and the authors make no representations with respect to the accuracy or completeness of the contents of all work on this website and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. The information published on this website may not be suitable for every situation. All work on this website is provided with the understanding that Perl.com and the authors are not engaged in rendering professional services. Neither Perl.com nor the authors shall be liable for damages arising herefrom.</p>
      </div>
    </div>
  </div>
</div>
<script src="/javascript/jquery.min.js"></script>
<script src="/javascript/bootstrap.min.js"></script>
<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10"></' + 'script>')</script></body>
</html>

