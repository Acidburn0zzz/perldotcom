<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title> Create RSS channels from HTML news sites </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content=" Even if you haven&#39;t heard of the RSS acronym before, you&#39;re likely to have used RSS in the past. Whether through the slashboxes at slashdot or our own news summary at use.perl.org, the premise remains the same - RSS,..."/>
  <meta name="robots" content="index, follow">
  <meta name="google-site-verification" content="TZowffo_LX2mmsw2DbeNNbukCMnIOA8T-6CMJPiYllI" />

<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@PerlFoundation">
<meta property="og:url" content="http://localhost:1313/pub/2001/11/15/creatingrss.html/" />
<meta property="og:title" content="Create RSS channels from HTML news sites" />
<meta property="og:description" content=" Even if you haven&#39;t heard of the RSS acronym before, you&#39;re likely to have used RSS in the past. Whether through the slashboxes at slashdot or our own news summary at use.perl.org, the premise remains the same - RSS,...">
<meta property="og:site_name" content="Perl.com" />

<meta property="og:type" content="article" />
<meta property="og:article:published_time" content="2001-11-11T11:11:11Z" />
<meta property="og:image" content="http://localhost:1313/images/_pub_2001_11_15_creatingrss/111-perlrss2.gif" />


  <link rel="icon" href="/favicon.ico">
  <link href="/article/index.xml" rel="alternate" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/article/index.xml" rel="feed" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/css/perldotcom.css"/>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50555-22', 'auto');
ga('create', 'UA-85734801-2', 'auto', 'editor');
ga('send', 'pageview');
ga('editor.send', 'pageview');
</script>

</head>
<body>

<div class="container-fluid full-wdith antonio">
 <div class="row">
  <div class="navbar-inverse" style="border-radius:none !important" role="navigation">
    <div class="container-fluid">
      <ul class="nav navbar-nav pull-right follow">
          <li>MORE:</li>
          <li><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a><li>
          <li><a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a><li>
          <li><a href="/article/index.xml" />
              <img src="/images/site/rss_20.png" alt="rss"></a></li>
          <li><a href="https://github.com/tpf/perldotcom" />
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></li>
      </ul>
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          <a class="navbar-nav" href="/">
            <div class="header-logo">Perl.com</div>
          </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/about">
              <div class="circle">
                <img src="/images/site/perl-camel.png" alt="" />
              </div>
                  &nbsp;&nbsp;ABOUT</a>
          </li>
          <li><a href="/authors">
              <div class="circle">
                  <span class="glyphicon glyphicon-user txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;AUTHORS</a>
          </li>
          <li><a href="/categories">
              <div class="circle">
                  <span class="glyphicon glyphicon-folder-open txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;CATEGORIES</a>
          </li>
          <li><a href="/tags">
              <div class="circle">
                <span class="txt-blue-major" aria-hidden="true"><strong>#</strong></span>
              </div>
                  &nbsp;&nbsp;TAGS</a>
          </li>
          <li>
            <form class="search" name="ddg" action="https://duckduckgo.com/" method="get">
              <input type="text" name ="q" placeholder="SEARCH" />
              <input type="hidden" value="perl.com" name="sites" />
            </form>
          </li>
        </ul>
      </div>
    </div>
  </div>
 </div>
</div>


  <section id="content" role="main">
    <section class="entry-content">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <article class="fulltext">
              <h1 class="blog-post-title">Create RSS channels from HTML news sites</h1>
              <p class="blog-post-meta">Nov 15, 2001 by
              
              
                
                
                <a href="#author-bio-chris-ball">Chris Ball</a>
              
              </p>
              <img alt="" src=""/>
                <p>Even if you haven&rsquo;t heard of the RSS acronym before, you&rsquo;re likely to have used RSS in the past. Whether through the slashboxes at <a href="http://slashdot.org">slashdot</a> or our own news summary at <a href="http://use.perl.org">use.perl.org</a>, the premise remains the same - RSS, or &ldquo;Remote Site Summary&rdquo; is a method used for providing an overview of the latest news to appear on a site.</p>

<p>RSS is an XML-based format, where the the site&rsquo;s information is described in a format that simplifies the news down to a few key elements. In the example we&rsquo;re going to run through, we&rsquo;ll concentrate particularly on the <em>title</em> and <em>link</em> tags. If you&rsquo;re interested in specifics of RSS, you can read more about it and see the full specification at <a href="http://my.netscape.com/publish/formats/rss-spec-0.91.html">netscape.com</a>; for the purposes of this tutorial, though, I&rsquo;m going to concentrate on how we can manipulate RSS with Perl and leave RSS internals alone.</p>

<p>So, you have a news site requiring an RSS feed; or let&rsquo;s say there&rsquo;s a news site that you want to get into RSS format. O&rsquo;Reilly&rsquo;s own <a href="http://meerkat.oreillynet.com">Meerkat</a> web site creates RSS descriptions of the news on other sites, and presents the latest news from all around the web as a news ticket. We&rsquo;re not going to use exactly the same method as Meerkat in this tutorial, but we&rsquo;ll use similar techniques to provide us with an RSS feed of the <a href="http://news.bbc.co.uk/">BBC News</a> web site.</p>

<p>So, what does our perl script need to do in order to turn the headlines on the site into an RSS channel? There are three main tasks that we&rsquo;ll be handling:</p>

<ul>
<li>Downloading the page for our script to work with,</li>
<li>Parsing the HTML on the page to give us meaningful summary information, and</li>
<li>Encoding the summary information in RSS.</li>
</ul>

<p>For anyone who&rsquo;s used the huge CPAN network of modules before, it&rsquo;s not going to be a huge surprise to hear that there are modules to help us accomplish each of our tasks here. We&rsquo;re going to be using <code>LWP::Simple</code> to handle downloading our page, <code>HTML::TokeParser</code> to parse our downloaded HTML into some meaningful English, and <code>XML::RSS</code> to create an RSS channel from our headlines and links.</p>

<p>Let&rsquo;s jump in to the code. After declaring our use of the modules we&rsquo;re going to be using&hellip;</p>

<pre><code>use strict;

use LWP::Simple;

use HTML::TokeParser;

use XML::RSS;
</code></pre>

<p>.. we&rsquo;re ready to create each of the objects we&rsquo;ll be using with each module. Note that while <code>LWP::Simple</code> uses a procedural interface, both <code>HTML::TokeParser</code> and <code>XML::RSS</code> have Object-Oriented interfaces. If you aren&rsquo;t used to OO in Perl, <a href="/authors/simon-cozens">Simon Cozens</a>&rsquo; recent <a href="/pub/2001/11/07/ooperl.html">article</a> on Object-Oriented Perl might be a great help.</p>

<pre><code># First - LWP::Simple.  Download the page using get();.

my $content = get( &quot;http://news.bbc.co.uk/&quot; ) or die $!;



# Second - Create a TokeParser object, using our downloaded HTML.

my $stream = HTML::TokeParser-&gt;new( \$content ) or die $!;



# Finally - create the RSS object. 

my $rss = XML::RSS-&gt;new( version =&gt; '0.9' );
</code></pre>

<p>Our next step in laying the foundations for our script is going to be to declare some variables and set the channel information on our RSS object. Every RSS channel carries some metadata; that&rsquo;s to say, data which provides information about the data that it encodes. For instance, it usually carries at least the channel&rsquo;s name, description, and an URL link. We&rsquo;re going to set up the metadata by calling the <code>channel</code> method on our object, like this:</p>

<pre><code># Prep the RSS.

$rss-&gt;channel(

    title        =&gt; &quot;news.bbc.co.uk&quot;,

    link         =&gt; &quot;http://news.bbc.co.uk/&quot;,

    description  =&gt; &quot;news.bbc.co.uk - World News from the BBC.&quot;);



# Declare variables.

my ($tag, headline, $url);
</code></pre>

<p>We now have all three of our modules primed and ready for use, and can move on to step two - obtaining plaintext information from our HTML page. This is where we need to apply our analytical skills to determine the layout of the web site we&rsquo;re looking at, and to find out how to find the headlines we wish to extract. The BBC&rsquo;s HTML layout is complex but predictable, and follows this routine:</p>

<ul>
<li>A <code>&lt;div class=&quot;bodytext&quot;&gt;</code> tag is present.</li>
<li>An <code>&lt;a&gt;</code> tag is opened, and then closed.</li>
<li>An <code>&lt;a&gt;</code> tag is opened, containing the URL we wish to grab, linking to the full text of the news article.</li>
<li>The <code>&lt;a&gt;</code> tag is closed, and a <code>&lt;b class=&quot;h1&quot;&gt;</code> or <code>&lt;b      class=&quot;h2&quot;&gt;</code> tag is opened.</li>
<li>Our headline lies between this <code>&lt;b&gt;</code> tag and a <code>&lt;/b&gt;</code> tag.</li>
</ul>

<p>At first glance, it seems like acquiring the url and headline in this situation is going to be awkward, but <code>HTML::TokeParser</code> makes light work of the page. The two important methods we are given by <code>HTML::TokeParser</code> are <code>get_tag</code> and <code>get_trimmed_text</code>.
<code>get_tag</code> skips forward in the HTML from our current position to the tag specified, and <code>get_trimmed_text</code> will grab plaintext from the current position to the end position specified. And so we can now translate our description of the BBC&rsquo;s layout into methods upon our <code>HTML::TokeParser</code> object, <code>$stream</code>.</p>

<pre><code># First indication of a headline - A &lt;div&gt; tag is present.

while ( $tag = $stream-&gt;get_tag(&quot;div&quot;) ) {



    # Inside this loop, $tag is at a &lt;div&gt; tag.

        # But do we have a &quot;class=&quot;bodytext&quot;&gt;&quot; token, too? 

    if ($tag-&gt;[1]{class} and $tag-&gt;[1]{class} eq 'bodytext') {



        # We do! 

                # The next step is an &lt;a&gt;&lt;/a&gt; set, which we aren't interested in.  

                # Let's go past it to the next &lt;a&gt;.

        $tag = $stream-&gt;get_tag('a'); $tag = $stream-&gt;get_tag('a');



        # Now, we're at the &lt;a&gt; with the headline in.

                # We need to put the contents of the 'href' token in $url.

        $url = $tag-&gt;[1]{href} || &quot;--&quot;;



        # That's $url done.  We can move on to $headline, and &lt;b&gt;

        $tag = $stream-&gt;get_tag('b');



        # Now we can grab $headline, by using get_trimmed_text 

                # up to the close of the &lt;b&gt; tag.

        # We want &lt;b class=&quot;h1&quot;&gt; or &lt;b class=&quot;h2&quot;&gt;.  

                # A regular expression will come in useful here. 

        $headline = $stream-&gt;get_trimmed_text('/b') \ 
                 if ($tag-&gt;[1]{class} =~ /^h[12]$/); 
</code></pre>

<p>We&rsquo;re getting there. We have the page downloaded, and we&rsquo;re inside a <code>while</code> loop that&rsquo;s going to grab every set of url and headline pairs on the page. All that&rsquo;s left to do is add <code>$url</code> and <code>$headline</code> to our RSS channel; but first, some tidying up..</p>

<pre><code>        # We need to escape ampersands, as they start entity references in XML.

        $url =~ s/&amp;/&amp;amp;/g;



        # The &lt;a&gt; tags contain relative URLs - we need to qualify these.

        $url = 'http://news.bbc.co.uk'.$url;



        # And that's it.  We can add our pair to the RSS channel. 

        $rss-&gt;add_item( title =&gt; $headline, link =&gt; $url);

    }

}
</code></pre>

<p>By the end of each iteration through the <code>&lt;div&gt;</code> tags, our <code>$rss</code> object is going to contain every title and link from the page. Now all we need to do is save it somewhere, and that&rsquo;s done with the <code>$rss-&gt;save</code> method.</p>

<pre><code>$rss-&gt;save(&quot;bbcnews.rss&quot;);
</code></pre>

<p>After executing our script, we get a &lsquo;<code>bbcnews.rss</code>&rsquo; file dumped in the current directory, and this can be processed by any RSS parser - for example, <a href="http://printf.net/evobbc.jpg">here</a>&rsquo;s my current mail client, Evolution, adding our data to the &lsquo;Executive Summary&rsquo; feature.</p>

<p>If we make this accessible on the web, as all good RSS feeds are, we can even get at this from our Slashboxes or use.perl news boxes. If you do want to make it web accessible, however, it&rsquo;s probably better to periodically create the RSS file from a <code>cron</code> job or similar, rather than using CGI, especially if you think the RSS is going to be accessed more often than the target site will be updated.</p>

<p>Of course, if you&rsquo;re creating an RSS feed for your own site, you have much greater control over the way you get your data. For instance, if you&rsquo;re using XML to produce your web site, you can use XML transformation techniques to produce RSS - but that&rsquo;s another tutorial for another time. For now, have fun, and happy spidering!</p>

              </article>
              <p><strong>Tags</strong></p>
              <div class="tags">
                <div class="category"><a href="/categories/web">web</a></div>
                
              </div>
            </div>
            
              
                
<div class="row" id="author-bio-chris-ball">
  <div class="col-sm-2">
    
    <a href="/authors/chris-ball/"><div class="circle-avatar" style="background-image:url(/images/site/avatar.png)"></div></a>
  </div>
  <div class="col-sm-10">
    <a href="/authors/chris-ball/"><h3>Chris Ball</h3></a>
    <p></p>
    <h5><a href="/authors/chris-ball/">Browse their articles</a></h5>
  </div>
</div>

            
            <div class="row">
              <h3>Feedback</h3>
              <p>Something wrong with this article? Help us out by opening an issue or pull request on <a href="https://github.com/tpf/perldotcom/blob/master/content/legacy/_pub_2001_11_15_creatingrss.md">GitHub</a></p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="latest-sidebar">

  <div class="row">
    <div class="col-sm-12 centering">
      <span style="font-size:1.8em" class="antonio txt-blue-major">OUR LATEST ARTICLES</span>
    </div>
  </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/the-perl-admbassador-curtis-poe/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/the-perl-ambassador-curtis-poe/curtis-poe.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>The Perl Ambassador: Curtis &#39;Ovid&#39; Poe</h6>
          <p style="line-height:1"><small>The person behind the news of Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/a-tour-with-net-ftp/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/a-tour-with-net-ftp/thumb_kidyes.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>A tour with Net::FTP</h6>
          <p style="line-height:1"><small>How to write an FTP client in Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/shortcode_test/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/author/brian-d-foy.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>shortcode_test</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/thumb_larry-wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Listen to Larry Wall&#39;s State of the Onion 2000 on YouTube</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/announcing-perl-7/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/announcing-perl-7/thumb_seven_on_blue_wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Announcing Perl 7</h6>
          <p style="line-height:1"><small>Perl 5 with modern defaults</small></p>
      </div>
        </a>
    </div>
  
</div>
<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
  <script async src="/widget/toplinks/toplinks.js" type="text/javascript"></script>
    <div id="toplinks"></div>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <a class="twitter-timeline" data-height="640" data-dnt="true" data-theme="dark" href="https://twitter.com/perlfoundation?ref_src=twsrc%5Etfw">Tweets by perlfoundation</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <script src="https://www.reddit.com/r/perl/hot/.embed?limit=10&t=all" type="text/javascript"></script>
  </div>
</div>



          </div>
        </div>
      </div>
    </section>
  </section>
<script>
 
var tables, i;
tables = document.getElementsByTagName('table');
for (i=0;i<tables.length;i++) {
  tables[i].className = 'table table-striped';
}
</script>
<div class="push"></div>
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <h5>Site Map</h5>
        <ul>
        <li><a href="/">Home</a></li>
        <hr>
        <li><a href="/about">About</a></li>
        <hr>
        <li><a href="/authors">Authors</a></li>
        <hr>
        <li><a href="/categories">Categories</a></li>
        <hr>
        <li><a href="/tags">Tags</a></li>
        <hr>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Contact Us</h5>
        <p>To get in touch, send an email to: perl.com-editor@perl.org</p>
        <p><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a>
          <a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a>
          <a href="/index.xml" /><img src="/images/site/rss_20.png" alt="rss"></a>
          <a href="https://github.com/tpf/perldotcom">
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></p>
      </div>
      <div class="col-md-2">
          <h5>License</h5>
          <p>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</p>
          <p><a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/3.0/88x31.png" /></a></p>
      </div>
      <div class="col-md-5">
          <h5>Legal</h5>
          <p>Perl.com and the authors make no representations with respect to the accuracy or completeness of the contents of all work on this website and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. The information published on this website may not be suitable for every situation. All work on this website is provided with the understanding that Perl.com and the authors are not engaged in rendering professional services. Neither Perl.com nor the authors shall be liable for damages arising herefrom.</p>
      </div>
    </div>
  </div>
</div>
<script src="/javascript/jquery.min.js"></script>
<script src="/javascript/bootstrap.min.js"></script>
<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10"></' + 'script>')</script></body>
</html>

