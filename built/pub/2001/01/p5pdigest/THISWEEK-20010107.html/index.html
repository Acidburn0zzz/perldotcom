<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title> This Fortnight on p5p 2000/12/31 </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content=" Notes Fix for gv_handler segfault rsync needs occasional delete Outstanding Unicode fix New Solaris hints file Lots of lvalue hackery Stephen McCamant and Doug MacEachern week Things to investigate Various Notes You can subscribe to an e-mail version of..."/>
  <meta name="robots" content="index, follow">
  <meta name="google-site-verification" content="TZowffo_LX2mmsw2DbeNNbukCMnIOA8T-6CMJPiYllI" />

<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@PerlFoundation">
<meta property="og:url" content="http://localhost:1313/pub/2001/01/p5pdigest/THISWEEK-20010107.html/" />
<meta property="og:title" content="This Fortnight on p5p 2000/12/31" />
<meta property="og:description" content=" Notes Fix for gv_handler segfault rsync needs occasional delete Outstanding Unicode fix New Solaris hints file Lots of lvalue hackery Stephen McCamant and Doug MacEachern week Things to investigate Various Notes You can subscribe to an e-mail version of...">
<meta property="og:site_name" content="Perl.com" />

<meta property="og:type" content="article" />
<meta property="og:article:published_time" content="2001-01-01T01:01:01Z" />
<meta property="og:image" content="http://localhost:1313/images/author/simon-cozens.jpg" />


  <link rel="icon" href="/favicon.ico">
  <link href="/article/index.xml" rel="alternate" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/article/index.xml" rel="feed" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/css/perldotcom.css"/>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50555-22', 'auto');
ga('create', 'UA-85734801-2', 'auto', 'editor');
ga('send', 'pageview');
ga('editor.send', 'pageview');
</script>

</head>
<body>

<div class="container-fluid full-wdith antonio">
 <div class="row">
  <div class="navbar-inverse" style="border-radius:none !important" role="navigation">
    <div class="container-fluid">
      <ul class="nav navbar-nav pull-right follow">
          <li>MORE:</li>
          <li><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a><li>
          <li><a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a><li>
          <li><a href="/article/index.xml" />
              <img src="/images/site/rss_20.png" alt="rss"></a></li>
          <li><a href="https://github.com/tpf/perldotcom" />
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></li>
      </ul>
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          <a class="navbar-nav" href="/">
            <div class="header-logo">Perl.com</div>
          </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/about">
              <div class="circle">
                <img src="/images/site/perl-camel.png" alt="" />
              </div>
                  &nbsp;&nbsp;ABOUT</a>
          </li>
          <li><a href="/authors">
              <div class="circle">
                  <span class="glyphicon glyphicon-user txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;AUTHORS</a>
          </li>
          <li><a href="/categories">
              <div class="circle">
                  <span class="glyphicon glyphicon-folder-open txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;CATEGORIES</a>
          </li>
          <li><a href="/tags">
              <div class="circle">
                <span class="txt-blue-major" aria-hidden="true"><strong>#</strong></span>
              </div>
                  &nbsp;&nbsp;TAGS</a>
          </li>
          <li>
            <form class="search" name="ddg" action="https://duckduckgo.com/" method="get">
              <input type="text" name ="q" placeholder="SEARCH" />
              <input type="hidden" value="perl.com" name="sites" />
            </form>
          </li>
        </ul>
      </div>
    </div>
  </div>
 </div>
</div>


  <section id="content" role="main">
    <section class="entry-content">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <article class="fulltext">
              <h1 class="blog-post-title">This Fortnight on p5p 2000/12/31</h1>
              <p class="blog-post-meta">Jan 9, 2001 by
              
              
                
                
                <a href="#author-bio-simon-cozens">Simon Cozens</a>
              
              </p>
              <img alt="" src=""/>
                

<ul>
<li><a href="#Notes">Notes</a></li>
<li><a href="#Fix_for_gv_handler_segfault">Fix for gv_handler segfault</a></li>
<li><a href="#rsync_needs_occasional_delete">rsync needs occasional delete</a></li>
<li><a href="#Outstanding_Unicode_fix">Outstanding Unicode fix</a></li>
<li><a href="#New_Solaris_hints_file">New Solaris hints file</a></li>
<li><a href="#Lots_of_lvalue_hackery">Lots of lvalue hackery</a></li>
<li><a href="#Stephen_McCamant_and_Doug_MacEachern_week">Stephen McCamant and Doug MacEachern week</a></li>
<li><a href="#Things_to_investigate">Things to investigate</a></li>
<li><a href="#Various">Various</a></li>
</ul>

<h3 id="span-id-notes-notes-span"><span id="Notes">Notes</span></h3>

<p>You can subscribe to an e-mail version of this summary by sending an empty message to <a href="mailto:p5p-digest-subscribe@plover.com"><code>p5p-digest-subscribe@plover.com</code>.</a></p>

<p>Please send corrections and additions to <code>perl-thisweek-YYYYMM@simon-cozens.org</code> where <code>YYYYMM</code> is the current year and month.</p>

<p>Allow me to apologize for there being no service last week, as I was traveling hither and thither for New Year&rsquo;s festivities. This is another special bumper edition covering last week and the week before.</p>

<h3 id="span-id-fix-for-gv-handler-segfault-fix-for-gv-handler-segfault-span"><span id="Fix_for_gv_handler_segfault">Fix for gv_handler segfault</span></h3>

<p>Lupe Christoph found an ugly bug uncovered by Ilya&rsquo;s recent object destruction speedup patch: Basically, we had called a function ( <code>mg_find</code>) on a stash before actually making sure that the stash existed, causing a segfault. Lupe added a sanity check to the handler function and <code>mg_find</code>, just to be on the safe side.</p>

<h3 id="span-id-rsync-needs-occasional-delete-rsync-needs-occasional-delete-span"><span id="rsync_needs_occasional_delete">rsync needs occasional delete</span></h3>

<p>Lupe also got bitten by a problem that could affect some of you if you&rsquo;re following the rsync mainline: Rsync won&rsquo;t, by default, delete files that have been deleted from the repository. This caused strange test failures, because the test that was failing doesn&rsquo;t exist any more &hellip; . He passes on these words of wisdom:</p>

<blockquote>
<p>Note that this will not delete any files that were in &lsquo;.&rsquo; before the rsync. Once you are sure that the rsync is running correctly, run it with the &ndash;delete and the &ndash;dry-run options like this:</p>

<p># rsync -avz &ndash;delete &ndash;dry-run rsync://ftp.linux.activestate.com/perl-current/ .</p>

<p>This will <em>simulate</em> an rsync run that also deletes files not present in the bleadperl master copy. Observe the results from this run closely. If you are sure that the actual run would delete no files precious to you, you could remove the &lsquo;&ndash;dry-run&rsquo; option.</p>
</blockquote>

<h3 id="span-id-outstanding-unicode-fix-outstanding-unicode-fix-span"><span id="Outstanding_Unicode_fix">Outstanding Unicode fix</span></h3>

<p>This sneaked in just as I was writing the previous summary: INABA Hiroto came up with a 48k patch that fixed a few Unicode bugs. He also added a pragma <code>unicode::distinct</code>, which makes a Unicode-encoded string never equal to a nonencoded string. That&rsquo;s to say, if we have:</p>

<pre><code>    $a = chr(50).chr(400); # Needs to be UTF8-encoded, because of chr(400)
    chop($a);              # Now we have chr(50), but it's still encoded.
    $b = chr(50)           # This isn't UTF8-encoded
</code></pre>

<p>Under normal circumstances, <code>$a eq $b</code>. This is what we expect, because they represent the same character. But under <code>unicode::distinct</code>, they won&rsquo;t be equal because they are represented differently.</p>

<p>He also fixed a few other issues I should have been looking at, like Unicode <code>tr///</code>.</p>

<h3 id="span-id-new-solaris-hints-file-new-solaris-hints-file-span"><span id="New_Solaris_hints_file">New Solaris hints file</span></h3>

<p>Lupe Christoph (again; busy man) attempted to update the Solaris hints file; it looked pretty good, but produced weird errors (No, Solaris machines are <strong>not</strong> EBCDIC. Or at least, not normally.) that were traced to a problem with Configure calling another shell file to get more information (a &ldquo;call back unit&rdquo;) but then getting confused as to where the source directory is. Robin Barker also found a similar problem when Configure sets <code>$src</code> using a relative path instead of an absolute one. The problem was eventually hunted down and shot, and the new hints file is now working properly.</p>

<p>Jarkko also re-wrote the DEC OSF hints file.</p>

<h3 id="span-id-lots-of-lvalue-hackery-lots-of-lvalue-hackery-span"><span id="Lots_of_lvalue_hackery">Lots of lvalue hackery</span></h3>

<p>I got into a very strange mood and started looking at lvalue subroutines. These are things that allow you to return a variable or something modifiable from a subroutine, like this:</p>

<pre><code> $a = 20;
 sub foo :lvalue { $a }
 foo() = 30; # Now $a is 30
</code></pre>

<p>The first problem was that this didn&rsquo;t extend to <code>AUTOLOAD</code>, meaning you couldn&rsquo;t say</p>

<pre><code> sub AUTOLOAD : lvalue { ${$AUTOLOAD} }
 foo() = 20;
</code></pre>

<p>and have it set <code>$foo</code>. Perhaps that was meant to be a feature, but it was fixed anyway. Of course, the natural extension to that would be to let subs be called without the brackets, like this:</p>

<pre><code> foo = 20;
</code></pre>

<p>(Bare words in lvalue context are now interpreted as either subs or filehandles, depending on what you have declared or open.)</p>

<p>Unfortunately, you can&rsquo;t return arrays, hashes or slices of arrays or hashes. This is where the trouble started. The problem is that you need to be able to tell, for instance, that the operator that returns an array that you actually do want the array itself, rather than a list of its elements. Look at this:</p>

<pre><code> @a = @b;
</code></pre>

<p>Here, <code>@a</code> is being modified, and so the actual AV is put onto the stack. But in the case of <code>@b</code>, the list of its elements is put on the stack. The difference is that the op for <code>@a</code> knows it&rsquo;s being modified, and the one for <code>@b</code> doesn&rsquo;t.</p>

<p>Back to lvalue subs - we&rsquo;ve got an operator in a subroutine that is going to be modified, so it needs to return the AV (the container) instead of the values. But which one?</p>

<p>There&rsquo;s nothing about an op that signifies that it&rsquo;s going to be used as a return value, so we don&rsquo;t know which op we need to tell that it&rsquo;s being modified. I had a go at a cheap way of doing it, but Stephen McCamant eventually persuaded me that it didn&rsquo;t really work, and he&rsquo;s now working on his own way of doing it, which looks quite nice. There followed a debate about what you ought to be able to return from an lvalue subroutine (Does <code>shift</code> constitute a modifiable value?) that is still going on. <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-01/msg00110.html">Read about it.</a></p>

<h3 id="span-id-stephen-mccamant-and-doug-maceachern-week-stephen-mccamant-and-doug-maceachern-week-span"><span id="Stephen_McCamant_and_Doug_MacEachern_week">Stephen McCamant and Doug MacEachern week</span></h3>

<p>The second week of the report, the first week in January, was dominated by a lot of good stuff from Stephen and Doug. As well as picking up where I left off on lvalue subroutines, Stephen identified a problem with tests depending on modules that might not have been built, (which must be a tricky area, because three people tried to patch it and only one succeeeded &hellip; ) and then came out with some really solid patches. He fixed a couple of problems with <code>B::Deparse</code> and also Perl&rsquo;s handling of <code>continue</code> blocks, and then a problem with all global variables looking like they&rsquo;d been declared with <code>our</code>. (This is quite a complex one, so if you&rsquo;re interested, <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-01/msg00246.html">read the patch description</a>.) To cap it all, he produced a useful tool that he believes is a replacement for <code>B::Terse</code>; it&rsquo;s called <code>B::Concise</code> and it allows you to control the output format through a pattern language, and you can get it from <a href="http://csua.berkeley.edu/~smcc/Concise.pm">http://csua.berkeley.edu/~smcc/Concise.pm</a>.</p>

<p>Not to be outdone, Doug noticed a conflict between two system header files, which could well be Linux being sloppy, and a conflict between PerlIO and stdio; he then patched the default XS typemap to use <code>Perl_croak</code> instead of the older, deprecated <code>croak</code>, tried to fix XSUBs to be declared static (but Nick I-S pointed out that wouldn&rsquo;t fly) but plumped for giving them an additional prototype to help with compiler warnings, and added a nice shortcut to the XS build process so you can say</p>

<pre><code> make MyModule.i
</code></pre>

<p>and get a pre-processed version of the C file. He also fixed some prototypes, and finished the week with a stroke of pure genius, allowing <code>AUTOLOAD</code> to be an XSUB.</p>

<h3 id="span-id-things-to-investigate-things-to-investigate-span"><span id="Things_to_investigate">Things to investigate</span></h3>

<p>Here are some things that out-of-work porters can investigate: (in fact, it would be really nice if everyone who submitted bug reports got <strong>some</strong> kind of feedback from a human being, so if you see something that hasn&rsquo;t been dealt with, why not look into it?)</p>

<p><a href="http://bugs.perl.org/perlbug.cgi?req=bid&amp;amp;amp;amp;bid=20010102.004&amp;amp;amp;amp;range=15148&amp;amp;amp;amp;format=H">This bug</a>appears to require a strange set of conditions, but generates a segfault; perhaps someone could find out where it&rsquo;s segfaulting, try and narrow down the problem, and report back.</p>

<p>A bizarre one from <code>torsten@sotlx2.sot.de</code>: &ldquo;When descending into a Joliet filesystem Find stops after the first level. Rockridge or ISO CDs are ok.&rdquo; (That&rsquo;s bug ID 20010103.001, if you&rsquo;re thinking of fixing it.)</p>

<p>For the scary and godlike, here&rsquo;s a <a href="http://bugs.perl.org/perlbug.cgi?req=bid&amp;amp;amp;amp;bid=20010104.011&amp;amp;amp;amp;range=15148&amp;amp;amp;amp;format=H">B::C bug</a> for you to chew on. Enjoy.</p>

<h3 id="span-id-various-various-span"><span id="Various">Various</span></h3>

<p>There is little else to report this week; a couple of reports of bugs fixed in the latest snapshots - if you&rsquo;re reporting a bug, could you please try it out in at least 5.7.0, if not more freqent snapshots, because we could already have fixed it. In the second week, there were many little patches that didn&rsquo;t generate any discussion but were still good to see. Only four new IV-preservation bugs this time.</p>

<p>Some spam, many test results (Thanks, Alan!) and a couple of nonbugs.</p>

<p>Until next week I remain, your humble and obedient servant,</p>

<hr />

<p><a href="mailto:simon@brecon.co.uk">Simon Cozens</a></p>

              </article>
              <p><strong>Tags</strong></p>
              <div class="tags">
                <div class="category"><a href="/categories/community">community</a></div>
                
              </div>
            </div>
            
              
                
<div class="row" id="author-bio-simon-cozens">
  <div class="col-sm-2">
    
    <a href="/authors/simon-cozens/"><div class="circle-avatar" style="background-image:url(/images/author/simon-cozens.jpg)"></div></a>
  </div>
  <div class="col-sm-10">
    <a href="/authors/simon-cozens/"><h3>Simon Cozens</h3></a>
    <p></p>
    <h5><a href="/authors/simon-cozens/">Browse their articles</a></h5>
  </div>
</div>

            
            <div class="row">
              <h3>Feedback</h3>
              <p>Something wrong with this article? Help us out by opening an issue or pull request on <a href="https://github.com/tpf/perldotcom/blob/master/content/legacy/_pub_2001_01_p5pdigest_THISWEEK-20010107.md">GitHub</a></p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="latest-sidebar">

  <div class="row">
    <div class="col-sm-12 centering">
      <span style="font-size:1.8em" class="antonio txt-blue-major">OUR LATEST ARTICLES</span>
    </div>
  </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/the-perl-admbassador-curtis-poe/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/the-perl-ambassador-curtis-poe/curtis-poe.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>The Perl Ambassador: Curtis &#39;Ovid&#39; Poe</h6>
          <p style="line-height:1"><small>The person behind the news of Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/a-tour-with-net-ftp/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/a-tour-with-net-ftp/thumb_kidyes.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>A tour with Net::FTP</h6>
          <p style="line-height:1"><small>How to write an FTP client in Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/shortcode_test/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/author/brian-d-foy.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>shortcode_test</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/thumb_larry-wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Listen to Larry Wall&#39;s State of the Onion 2000 on YouTube</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/announcing-perl-7/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/announcing-perl-7/thumb_seven_on_blue_wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Announcing Perl 7</h6>
          <p style="line-height:1"><small>Perl 5 with modern defaults</small></p>
      </div>
        </a>
    </div>
  
</div>
<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
  <script async src="/widget/toplinks/toplinks.js" type="text/javascript"></script>
    <div id="toplinks"></div>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <a class="twitter-timeline" data-height="640" data-dnt="true" data-theme="dark" href="https://twitter.com/perlfoundation?ref_src=twsrc%5Etfw">Tweets by perlfoundation</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <script src="https://www.reddit.com/r/perl/hot/.embed?limit=10&t=all" type="text/javascript"></script>
  </div>
</div>



          </div>
        </div>
      </div>
    </section>
  </section>
<script>
 
var tables, i;
tables = document.getElementsByTagName('table');
for (i=0;i<tables.length;i++) {
  tables[i].className = 'table table-striped';
}
</script>
<div class="push"></div>
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <h5>Site Map</h5>
        <ul>
        <li><a href="/">Home</a></li>
        <hr>
        <li><a href="/about">About</a></li>
        <hr>
        <li><a href="/authors">Authors</a></li>
        <hr>
        <li><a href="/categories">Categories</a></li>
        <hr>
        <li><a href="/tags">Tags</a></li>
        <hr>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Contact Us</h5>
        <p>To get in touch, send an email to: perl.com-editor@perl.org</p>
        <p><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a>
          <a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a>
          <a href="/index.xml" /><img src="/images/site/rss_20.png" alt="rss"></a>
          <a href="https://github.com/tpf/perldotcom">
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></p>
      </div>
      <div class="col-md-2">
          <h5>License</h5>
          <p>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</p>
          <p><a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/3.0/88x31.png" /></a></p>
      </div>
      <div class="col-md-5">
          <h5>Legal</h5>
          <p>Perl.com and the authors make no representations with respect to the accuracy or completeness of the contents of all work on this website and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. The information published on this website may not be suitable for every situation. All work on this website is provided with the understanding that Perl.com and the authors are not engaged in rendering professional services. Neither Perl.com nor the authors shall be liable for damages arising herefrom.</p>
      </div>
    </div>
  </div>
</div>
<script src="/javascript/jquery.min.js"></script>
<script src="/javascript/bootstrap.min.js"></script>
<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10"></' + 'script>')</script></body>
</html>

