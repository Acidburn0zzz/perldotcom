<!DOCTYPE html>
<html lang="en-us">
  <head>
  <title> This Week on p5p 2001/01/21 </title>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="description" content=" Notes Notes sigsetjmp wrangling continues Safe Signals Large file support wrangling continues Multiple Pre-Incrementing Test::Harness Megapatch Tokeniser reporting and pretty-printing Unicode Various You can subscribe to an email version of this summary by sending an empty message to p5p-digest-subscribe@plover.com...."/>
  <meta name="robots" content="index, follow">
  <meta name="google-site-verification" content="TZowffo_LX2mmsw2DbeNNbukCMnIOA8T-6CMJPiYllI" />

<meta property="twitter:card" content="summary">
<meta property="twitter:site" content="@PerlFoundation">
<meta property="og:url" content="http://localhost:1313/pub/2001/01/p5pdigest/THISWEEK-20010121.html/" />
<meta property="og:title" content="This Week on p5p 2001/01/21" />
<meta property="og:description" content=" Notes Notes sigsetjmp wrangling continues Safe Signals Large file support wrangling continues Multiple Pre-Incrementing Test::Harness Megapatch Tokeniser reporting and pretty-printing Unicode Various You can subscribe to an email version of this summary by sending an empty message to p5p-digest-subscribe@plover.com....">
<meta property="og:site_name" content="Perl.com" />

<meta property="og:type" content="article" />
<meta property="og:article:published_time" content="2001-01-01T01:01:01Z" />
<meta property="og:image" content="http://localhost:1313/images/author/simon-cozens.jpg" />


  <link rel="icon" href="/favicon.ico">
  <link href="/article/index.xml" rel="alternate" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/article/index.xml" rel="feed" type="application/rss+xml" title="Perl.com - programming news, code and culture" />
  <link href="/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" type="text/css" href="/css/perldotcom.css"/>


<script>
(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

ga('create', 'UA-50555-22', 'auto');
ga('create', 'UA-85734801-2', 'auto', 'editor');
ga('send', 'pageview');
ga('editor.send', 'pageview');
</script>

</head>
<body>

<div class="container-fluid full-wdith antonio">
 <div class="row">
  <div class="navbar-inverse" style="border-radius:none !important" role="navigation">
    <div class="container-fluid">
      <ul class="nav navbar-nav pull-right follow">
          <li>MORE:</li>
          <li><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a><li>
          <li><a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a><li>
          <li><a href="/article/index.xml" />
              <img src="/images/site/rss_20.png" alt="rss"></a></li>
          <li><a href="https://github.com/tpf/perldotcom" />
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></li>
      </ul>
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
          <a class="navbar-nav" href="/">
            <div class="header-logo">Perl.com</div>
          </a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav">
          <li><a href="/about">
              <div class="circle">
                <img src="/images/site/perl-camel.png" alt="" />
              </div>
                  &nbsp;&nbsp;ABOUT</a>
          </li>
          <li><a href="/authors">
              <div class="circle">
                  <span class="glyphicon glyphicon-user txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;AUTHORS</a>
          </li>
          <li><a href="/categories">
              <div class="circle">
                  <span class="glyphicon glyphicon-folder-open txt-blue-major" aria-hidden="true"></span>
              </div>
                  &nbsp;&nbsp;CATEGORIES</a>
          </li>
          <li><a href="/tags">
              <div class="circle">
                <span class="txt-blue-major" aria-hidden="true"><strong>#</strong></span>
              </div>
                  &nbsp;&nbsp;TAGS</a>
          </li>
          <li>
            <form class="search" name="ddg" action="https://duckduckgo.com/" method="get">
              <input type="text" name ="q" placeholder="SEARCH" />
              <input type="hidden" value="perl.com" name="sites" />
            </form>
          </li>
        </ul>
      </div>
    </div>
  </div>
 </div>
</div>


  <section id="content" role="main">
    <section class="entry-content">
      <div class="container">
        <div class="row">
          <div class="col-md-9">
            <div class="row">
              <article class="fulltext">
              <h1 class="blog-post-title">This Week on p5p 2001/01/21</h1>
              <p class="blog-post-meta">Jan 24, 2001 by
              
              
                
                
                <a href="#author-bio-simon-cozens">Simon Cozens</a>
              
              </p>
              <img alt="" src=""/>
                

<h3 id="span-id-notes-notes-span"><span id="Notes">Notes</span></h3>

<ul>
<li><a href="#Notes">Notes</a></li>
<li><a href="#sigsetjmp_wrangling_continues">sigsetjmp wrangling continues</a></li>
<li><a href="#Safe_Signals">Safe Signals</a></li>
<li><a href="#Large_file_support_wrangling_continues">Large file support wrangling continues</a></li>
<li><a href="#Multiple_Pre_Incrementing">Multiple Pre-Incrementing</a></li>
<li><a href="#TestHarness_Megapatch">Test::Harness Megapatch</a></li>
<li><a href="#Tokeniser_reporting_and_pretty_printing">Tokeniser reporting and pretty-printing</a></li>
<li><a href="#Unicode">Unicode</a></li>
<li><a href="#Various">Various</a></li>
</ul>

<p>You can subscribe to an email version of this summary by sending an empty message to <a href="mailto:p5p-digest-subscribe@plover.com"><code>p5p-digest-subscribe@plover.com</code>.</a></p>

<p>Please send corrections and additions to <code>perl-thisweek-YYYYMM@simon-cozens.org</code> where <code>YYYYMM</code> is the current year and month.</p>

<h3 id="span-id-sigsetjmp-wrangling-continues-sigsetjmp-wrangling-continues-span"><span id="sigsetjmp_wrangling_continues">sigsetjmp wrangling continues</span></h3>

<p>Last week, there was some discussion about whether Perl ought to use <code>sigsetjmp</code> to jump out of <code>eval</code>s and to <code>die</code>. Part of the problem is that <code>sigsetjmp</code> is quite a lot slower than <code>setjmp</code>, so if we can get by without it, we ought to. Nick Ing-Simmons has removed <code>sigsetjmp</code> from the current sources, but now Nick Clark has found that this can sometimes cause a slowdown due to bizarre optimizing.</p>

<p>The discussion then veered onto the problems of using any sort of non-local jump with threads. Alan pointed out that neither <code>sigjmp</code> nor <code>sigsetjmp</code> were thread-safe at all, and since Perl uses them, Perl&rsquo;s threading implementation is horrifically broken. There were no good suggestions about how to get around this, or to getaway without non-local jumps for trapping exceptions. Alan declared Perl 5 beyond hope, but said:</p>

<blockquote>
<p>If perl6 has something akin to the perl5 stack, eval/die will have to be implemented so that that it rolls back up the stack on die, rather than the current longjmp hack.</p>
</blockquote>

<p>Alan also suggested that we would need to roll our own threading model in Perl 6 to have full control over exception handling; the discussion carried on about Perl 6 over on the <code>perl6-internals</code> mailing list.</p>

<p>The part where it gets interesting this week starts <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-01/msg01023.html">here</a>.</p>

<h3 id="span-id-safe-signals-safe-signals-span"><span id="Safe_Signals">Safe Signals</span></h3>

<p>Nick came up with a program for people to try to confirm his suspicions about signal handling. His plan was to have C set a flag in the signal handler which is checked after each op is performed, which seems the most obvious way of doing it, but he was worried about systems with signal handlers where <code>SIGCHLD</code> didn&rsquo;t call <code>wait</code>, meaning there would be still outstanding children when the signal handler returned, meaning a <code>SIGCHLD</code> would be delivered, meaning the handler would get called, rince and repeat.</p>

<p>However, every platform that was tested worked sensibly, so it looks like Nick is going to go ahead and try and implement safe signals.</p>

<h3 id="span-id-large-file-support-wrangling-continues-large-file-support-wrangling-continues-span"><span id="Large_file_support_wrangling_continues">Large file support wrangling continues</span></h3>

<p>The discussion last week about Linux&rsquo;s large file support continued this week. The problem is that we need to find the right preprocessor directive to get the most use out of the system; most of the ones which look useful ( <code>_GNU_SOURCE</code>, for instance) also expose other things that we don&rsquo;t necessarily want. It would also throw up problems in programs embedding Perl. Russ Allbery had been through all this with both INN and <code>autoconf</code>. His advice:</p>

<blockquote>
<p>Eventually, the autoconf folks decided to give up on glibc 2.1 as broken for large files and just recommend people upgrade to glibc 2.2 or add -D_GNU_SOURCE manually if it works for their application.</p>
</blockquote>

<h3 id="span-id-multiple-pre-incrementing-multiple-pre-incrementing-span"><span id="Multiple_Pre_Incrementing">Multiple Pre-Incrementing</span></h3>

<p>I decided to throw a spaniel in the works by submitting a patch to make</p>

<pre><code>    print (++$i, ++$i, ++$i)
</code></pre>

<p>work as John Vromans would like; currently, Perl reserves the right to do, well, pretty much anything it wants in that situation, but the &ldquo;obvious&rdquo; thing for it to print would be (assuming <code>$i</code> was undefined before hand) &ldquo;123&rdquo;. There were some arguments as to why this would be a bad idea - firstly, defining behaviour that is currently undefined robs us of the right to make clever optimizations in the future, and also that the fix slows down the behaviour of pre-increment and pre-decrement for everyone, not just those doing multiple pre-increments in a single statement.</p>

<p>I also wondered whether the confusion at seeing Perl output &ldquo;333&rdquo; in the above code would be offset by the confusion required to try something like that in a serious program anyway.</p>

<h3 id="span-id-testharness-megapatch-test-harness-megapatch-span"><span id="TestHarness_Megapatch">Test::Harness Megapatch</span></h3>

<p>Michael Schwern did his usual trick of popping up out of nowhere with a 40K patch - this time he rewrote <code>Test::Harness</code> to support a lot of sensible things, like the trick of having comments after your message, like this:</p>

<pre><code>    ok 123 - Testing the frobnicator
</code></pre>

<p>so that when tests fail you can can search for that string. He went back and forth with Andreas about some of the new features - Andreas felt that, for instance, allowing upper case output creates additional noise and distraction. Jarkko agreed, and the patch got fried.</p>

<p>Not put off, Schwern then went on to unify the <code>skip</code> and <code>todo</code> interfaces. Unfortunately, that couldn&rsquo;t be done without breaking existing code, especially CPAN modules, so that patch died the death too. Oh, the embarrassment.</p>

<h3 id="span-id-tokeniser-reporting-and-pretty-printing-tokeniser-reporting-and-pretty-printing-span"><span id="Tokeniser_reporting_and_pretty_printing">Tokeniser reporting and pretty-printing</span></h3>

<p>I did something evil again. After hearing a talk by Knuth about Literate Programming, I went back to bemoaning the lack of a Perl pretty-printer, and the depressing words in the FAQ:</p>

<blockquote>
<p>There is no program that will reformat Perl as much as indent(1) will do for C. The complex feedback between the scanner and the parser (this feedback is what confuses the vgrind and emacs programs) makes it challenging at best to write a stand-alone Perl parser.</p>
</blockquote>

<p>So if I couldn&rsquo;t build a stand-alone parser, I&rsquo;d use the one we&rsquo;ve got - <code>perl</code>. By adding a call to a reporting function every time Perl makes a decision about what a token is, you can generate a listing of all the tokens in a program and their types. Implementation of a robust pretty-printer is <a href="http://www.xray.mpe.mpg.de/mailing-lists/perl5-porters/2001-01/msg00833.html">left as an exercise for the reader</a>; answers on a postcard, please.</p>

<p>(PS: I&rsquo;ve since been alerted to the existence of Tim Maher&rsquo;s <a href="http://www.consultix-inc.com/perl_beautifier.html">Perl beautifier</a>, which is an equally cool hack.)</p>

<h3 id="span-id-unicode-unicode-span"><span id="Unicode">Unicode</span></h3>

<p>How could I go a week without mentioning Unicode? Hiroto&rsquo;s <code>qu</code> operator is in, and someone&rsquo;s obviously using it, because Nick Clark found that it was turning up a bug in UTF8 hashes - <code>$foo{something}</code> and <code>$foo{qu/something/}</code> were being seen as two different keys. Hiroto said he was aware of it and meant to send a patch but hasn&rsquo;t managed to yet.</p>

<p>UTF8 support on EBCDIC is starting to work, but it&rsquo;s being done in a bit of a bizarre way - we&rsquo;re actually using UTF8 to encode <strong>EBCDIC itself</strong>, rather than Unicode. This means that whileEBCDIC and non-EBCDIC platforms now both &ldquo;support&rdquo; UTF8 and all the code (on the whole) works, Weird Things&trade; might happen if EBCDIC people start playing with character classes or other Unicode features.</p>

<h3 id="span-id-various-various-span"><span id="Various">Various</span></h3>

<p>IV preservation is still buggy.</p>

<p>I&rsquo;ll leave you with the news that several people reported problems with the bug-reporting system; Perl is so great, even its bugs have bugs.</p>

<p>Until next week I remain, your humble and obedient servant,</p>

<hr />

<p><a href="mailto:simon@brecon.co.uk">Simon Couzens</a></p>

              </article>
              <p><strong>Tags</strong></p>
              <div class="tags">
                <div class="category"><a href="/categories/community">community</a></div>
                
              </div>
            </div>
            
              
                
<div class="row" id="author-bio-simon-cozens">
  <div class="col-sm-2">
    
    <a href="/authors/simon-cozens/"><div class="circle-avatar" style="background-image:url(/images/author/simon-cozens.jpg)"></div></a>
  </div>
  <div class="col-sm-10">
    <a href="/authors/simon-cozens/"><h3>Simon Cozens</h3></a>
    <p></p>
    <h5><a href="/authors/simon-cozens/">Browse their articles</a></h5>
  </div>
</div>

            
            <div class="row">
              <h3>Feedback</h3>
              <p>Something wrong with this article? Help us out by opening an issue or pull request on <a href="https://github.com/tpf/perldotcom/blob/master/content/legacy/_pub_2001_01_p5pdigest_THISWEEK-20010121.md">GitHub</a></p>
            </div>
          </div>
          <div class="col-md-3">
            <div class="latest-sidebar">

  <div class="row">
    <div class="col-sm-12 centering">
      <span style="font-size:1.8em" class="antonio txt-blue-major">OUR LATEST ARTICLES</span>
    </div>
  </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/the-perl-admbassador-curtis-poe/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/the-perl-ambassador-curtis-poe/curtis-poe.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>The Perl Ambassador: Curtis &#39;Ovid&#39; Poe</h6>
          <p style="line-height:1"><small>The person behind the news of Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/a-tour-with-net-ftp/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/a-tour-with-net-ftp/thumb_kidyes.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>A tour with Net::FTP</h6>
          <p style="line-height:1"><small>How to write an FTP client in Perl</small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/shortcode_test/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/author/brian-d-foy.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>shortcode_test</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/listen-to-larry-wall-s-state-of-the-onion-2000-on-youtube/thumb_larry-wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Listen to Larry Wall&#39;s State of the Onion 2000 on YouTube</h6>
          <p style="line-height:1"><small></small></p>
      </div>
        </a>
    </div>
  
    
    
    <div class="row">
        <a href="http://localhost:1313/article/announcing-perl-7/">
      <div class="col-sm-3">
        <div class="circle-avatar" style="background-image:url(/images/announcing-perl-7/thumb_seven_on_blue_wall.jpg)"></div>
      </div>
      <div class="col-sm-9">
          <h6>Announcing Perl 7</h6>
          <p style="line-height:1"><small>Perl 5 with modern defaults</small></p>
      </div>
        </a>
    </div>
  
</div>
<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
  <script async src="/widget/toplinks/toplinks.js" type="text/javascript"></script>
    <div id="toplinks"></div>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <a class="twitter-timeline" data-height="640" data-dnt="true" data-theme="dark" href="https://twitter.com/perlfoundation?ref_src=twsrc%5Etfw">Tweets by perlfoundation</a> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div>
</div>

<div class="row" style="margin-top:20px">
  <div class="col-sm-12 centering">
    <script src="https://www.reddit.com/r/perl/hot/.embed?limit=10&t=all" type="text/javascript"></script>
  </div>
</div>



          </div>
        </div>
      </div>
    </section>
  </section>
<script>
 
var tables, i;
tables = document.getElementsByTagName('table');
for (i=0;i<tables.length;i++) {
  tables[i].className = 'table table-striped';
}
</script>
<div class="push"></div>
<div class="footer">
  <div class="container">
    <div class="row">
      <div class="col-md-1">
        <h5>Site Map</h5>
        <ul>
        <li><a href="/">Home</a></li>
        <hr>
        <li><a href="/about">About</a></li>
        <hr>
        <li><a href="/authors">Authors</a></li>
        <hr>
        <li><a href="/categories">Categories</a></li>
        <hr>
        <li><a href="/tags">Tags</a></li>
        <hr>
        </ul>
      </div>
      <div class="col-md-3">
        <h5>Contact Us</h5>
        <p>To get in touch, send an email to: perl.com-editor@perl.org</p>
        <p><a href="https://perl.org">
              <img src="/images/site/perl-onion_20.png" alt="Perl Onion"></a>
          <a href="https://twitter.com/intent/follow?screen_name=perlfoundation">
              <img src="/images/site/twitter_20.png" alt="twitter"></a>
          <a href="/index.xml" /><img src="/images/site/rss_20.png" alt="rss"></a>
          <a href="https://github.com/tpf/perldotcom">
              <img src="/images/site/github_light_20.png" alt="GitHub logo"></a></p>
      </div>
      <div class="col-md-2">
          <h5>License</h5>
          <p>This work is licensed under a <a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/">Creative Commons Attribution-NonCommercial 3.0 Unported License</a>.</p>
          <p><a rel="license" href="https://creativecommons.org/licenses/by-nc/3.0/"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-nc/3.0/88x31.png" /></a></p>
      </div>
      <div class="col-md-5">
          <h5>Legal</h5>
          <p>Perl.com and the authors make no representations with respect to the accuracy or completeness of the contents of all work on this website and specifically disclaim all warranties, including without limitation warranties of fitness for a particular purpose. The information published on this website may not be suitable for every situation. All work on this website is provided with the understanding that Perl.com and the authors are not engaged in rendering professional services. Neither Perl.com nor the authors shall be liable for damages arising herefrom.</p>
      </div>
    </div>
  </div>
</div>
<script src="/javascript/jquery.min.js"></script>
<script src="/javascript/bootstrap.min.js"></script>
<script data-no-instant>document.write('<script src="/livereload.js?port=1313&mindelay=10"></' + 'script>')</script></body>
</html>

